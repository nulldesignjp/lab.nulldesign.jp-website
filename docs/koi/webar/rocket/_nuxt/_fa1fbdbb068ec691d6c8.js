(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{182:function(t,e,o){var content=o(200);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(63).default)("31b988b4",content,!0,{sourceMap:!1})},183:function(t,e,o){var content=o(202);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(63).default)("6759f5ab",content,!0,{sourceMap:!1})},199:function(t,e,o){"use strict";var n=o(182);o.n(n).a},200:function(t,e,o){(e=o(62)(!1)).push([t.i,".artwork{z-index:-1}.artwork,.artwork__canvas,.artwork__video{position:fixed;left:0;top:0;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.artwork__canvas,.artwork__video{display:block;z-index:-2}.artwork__video{-o-object-fit:fill;object-fit:fill}.artwork__button{position:fixed;left:50%;top:50%;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:2;font-size:1.2em;width:320px;height:128px;margin:-64px 0 0 -160px;border:1px solid hsla(0,0%,100%,.6);border-radius:8px;background:hsla(0,0%,100%,.6);box-shadow:0 0 16px rgba(0,0,0,.1)}.artwork__button.hide,.hide{display:none}",""]),t.exports=e},201:function(t,e,o){"use strict";var n=o(183);o.n(n).a},202:function(t,e,o){(e=o(62)(!1)).push([t.i,"body,html{overflow:hidden;font-family:Heebo}body{background:#000}.title{margin:16px 16px 0;padding:4px 4px 0}.description,.title{line-height:1;font-weight:400;background:hsla(0,0%,100%,.2);font-weight:100;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.description{margin:0 16px;padding:0 4px 4px;font-size:1em}.message{position:fixed;bottom:8px;left:0;width:100%;margin:0;padding:4px 4px 0;line-height:1;font-weight:400;background:hsla(0,0%,100%,.4);font-weight:100;display:none;text-align:center}.message.show{display:block}",""]),t.exports=e},206:function(t,e,o){"use strict";o.r(e);var n=o(178),r=o(179),c=o(177),h=(o(20),o(21),o(13),o(191),o(203),o(204),o(205),o(184),o(185),o(193),o(181),o(194),o(186),o(195)),l=o(196);var d=function(){function t(e,o,r){Object(n.a)(this,t);var c=this;this.scene,this.camera,this.focus,this.renderer,this.mode,this.clock,this.time,this.timeScale,this.animationKey,this.controls,this.raycaster,this.composer,o=null==o?16777215:o,this.mode=null==r?0:r,this.init(e,o,this.mode),window.addEventListener("resize",(function(){c.resize()})),this.resize()}return Object(r.a)(t,[{key:"init",value:function(t,e,o){this.clock=new c.j,this.time=0;var n=window.innerWidth,r=window.innerHeight;this.scene=new c.db,this.camera=new c.R(60,n/r,.01,1e3),this.camera.position.set(0,0,500),this.focus=new c.pb(0,0,0),this.renderer=new c.tb({antialias:!0,canvas:t,alpha:!0}),this.renderer.setSize(n,r),this.renderer.setClearColor(e),this.renderer.autoClearColor=!1,this.renderer.autoClear=!1,this.renderer.render(this.scene,this.camera),this.raycaster=new c.bb}},{key:"render",value:function(){var t=this;this.animationKey=window.requestAnimationFrame((function(){t.render()}));var e=this.clock.getDelta();this.time+=e*this.timeScale,null!=this.controls&&(0==this.controls.alphaOffset&&0!=this.camera.rotation.y&&(this.controls.alphaOffset=-1*this.camera.rotation.y),this.controls.update()),this.renderer.render(this.scene,this.camera)}},{key:"resize",value:function(){console.log("resize....");var t=window.innerWidth,e=window.innerHeight;this.renderer.setSize(t,e),this.camera.aspect?this.camera.aspect=t/e:(this.camera.left=.5*-t,this.camera.right=.5*t,this.camera.bottom=.5*-e,this.camera.top=.5*e),this.camera.updateProjectionMatrix()}},{key:"getWorldToScreen2D",value:function(t){var e=new c.pb,o=this.renderer.getContext(),n=.5*o.canvas.width,r=.5*o.canvas.height;t.updateMatrixWorld(),e.setFromMatrixPosition(t.matrixWorld),e.project(this.camera),e.x=e.x*n+n,e.y=-e.y*r+r;var h=(new c.pb).subVectors(this.focus,this.camera.position),l=(new c.pb).subVectors(t.position,this.camera.position);return h.dot(l)<=0&&(e.x=-9999,e.y=-9999),{x:e.x,y:e.y}}},{key:"focalLengthToFOV",value:function(t){var e=this.camera.filmGauge,o=2*e/3,n=Math.sqrt(e*e+o*o);this.camera.fov=180/Math.PI*Math.atan(n/(2*t))*2,this.camera.updateProjectionMatrix()}},{key:"pixelEqualMagnification",value:function(){return.5*window.innerHeight/Math.tan(.5*_world.camera.fov*Math.PI/180)}},{key:"add",value:function(t){this.scene.add(t)}},{key:"remove",value:function(t){if(t.geometry.dispose(),null!=t.material.uniforms)for(var i in null!=t.material.uniforms.value.dispose)t.material.uniforms[i].value.dispose();null!=t.material.map&&t.material.map.dispose(),this.scene.remove(t)}},{key:"renderStart",value:function(){this.renderStop(),this.clock.start(),this.render(0)}},{key:"renderStop",value:function(){window.cancelAnimationFrame(this.animationKey),this.clock.stop()}},{key:"addOrbitControls",value:function(){this.controls=new l.a(this.camera,this.renderer.domElement),this.controls.autoRotate=!1,this.controls.autoRotateSpeed=.2,this.controls.enableDamping=!0,this.controls.dampingFactor=.15,this.controls.enableZoom=!0,this.controls.enabled=!0,this.controls.target=this.focus}},{key:"addDeviceOrientationControls",value:function(){this.controls=new h.a(this.camera),this.controls.connect()}},{key:"addDevicemotion",value:function(t){}},{key:"dispose",value:function(){this.renderStop(),this.scene.dispose(),this.renderer.dispose(),this.controls.dispose(),this.scene=null,this.renderer=null,this.controls=null,this.camera=null,this.focus=null,this.clock=null,this.time=null,this.timeScale=null,this.animationKey=null,this.raycaster=null,this.composer=null}}]),t}(),w=(o(197),o(187)),v=(o(189),o(22),o(198),function(){function t(e){Object(n.a)(this,t),this.props=e,this.scene,this.clock,this.time,this.loopKey,this.objects,this.smokes,this.master,this.isInit,this.init()}return Object(r.a)(t,[{key:"init",value:function(){this.scene=new c.db,this.clock=new c.j,this.objects=[],this.smokes=[],this.isInit=!1,this.time=0;var t=new c.b(16777215,.5),e=new c.m(16777215,1);e.position.set(1,2,3),this.scene.add(t),this.scene.add(e);var o=this;(new w.a).load("assets/fbx/starship.fbx",(function(object){object.scale.x=object.scale.y=object.scale.z=.01,object.traverse((function(t){t.isMesh&&(t.castShadow=!0,t.receiveShadow=!0)})),o.master=object,o.isInit=!0})),this.update()}},{key:"fire",value:function(t,e,o,n,r){if(this.isInit){var c=this.master.clone();c.position.set(o,n,r),c.rotation.y=Math.random()*Math.PI*2,c.scale.set(1e-4,1e-4,1e-4),this.objects.push({mesh:c,velocity:0,time:this.time}),this.scene.add(c)}}},{key:"update",value:function(){var t=this;this.loopKey=window.requestAnimationFrame((function(){t.update()})),this.time+=this.clock.getDelta();for(var e=new c.x(1,0),o=this.objects.length;o;){o--;var n=this.objects[o].mesh;this.objects[o].velocity+=2e-4;var r=this.time-this.objects[o].time,h=this.easeOutElastic(r,0,.01,1);if(h=r>1?.01:h,n.scale.set(h,h,h),r>1.8&&(n.position.y+=this.objects[o].velocity,n.rotation.y+=.5*this.objects[o].velocity),Math.random()<.4&&r>1){var l=new c.M({color:16777215,transparent:!0,opacity:1,flatShading:!0}),d=new c.J(e,l);t.scene.add(d),d.rotation.x=Math.random()*Math.PI*2,d.rotation.y=Math.random()*Math.PI*2,d.rotation.z=Math.random()*Math.PI*2;d.scale.set(.1,.1,.1);var w=.05*Math.random(),v=Math.random()*Math.PI*2,m=Math.cos(v)*w,f=Math.sin(v)*w;d.position.set(n.position.x+m,n.position.y-.5,n.position.z+f),this.smokes.push(d)}n.position.y>100&&(this.scene.remove(n),this.objects.splice(o,1))}for(o=this.smokes.length;o;){o--,(d=this.smokes[o]).material.opacity-=.02,d.scale.x+=.01,d.scale.y+=.01,d.scale.z+=.01,d.material.opacity<=0&&(this.scene.remove(d),this.smokes.splice(o,1))}}},{key:"easeOutElastic",value:function(t,b,e,o){if(0==t)return b;if(1==(t/=o))return b+e;var s,p=.3*o,a=0;return!Boolean(a)||a<Math.abs(e)?(a=e,s=p/4):s=p/(2*Math.PI)*Math.asin(e/a),a*Math.pow(2,-10*t)*Math.sin((t*o-s)*(2*Math.PI)/p)+e+b}},{key:"resize",value:function(){}},{key:"start",value:function(){this.stop(),this.update(),this.clock.start()}},{key:"stop",value:function(){window.cancelAnimationFrame(this.loopKey),this.clock.stop()}},{key:"addEvents",value:function(){}},{key:"removeEvents",value:function(){}},{key:"dispose",value:function(){this.removeEvents(),this.stop()}}]),t}()),m=function(){function t(e){Object(n.a)(this,t),this.props=e,this.world,this.scene,this.video,this.surface,this.raycaster,this.tapPosition,this.loopKey,this.isSP=!1;var o=navigator.userAgent.toLowerCase();-1==o.indexOf("iphone")&&-1==o.indexOf("ipad")&&-1==o.indexOf("android")||(this.isSP=!0),this.init(),this.loop();var r=this;if(this.isSP)this.addVideo(),this.props.$button.addEventListener("mousedown",(function(t){r.addDeviceOrientationControls(t)}));else{this.world.addOrbitControls(),this.props.$button.setAttribute("style","display:none;");var h="https://api.qrserver.com/v1/create-qr-code/?size=256x256&data="+location.href;(new c.lb).load(h,(function(t){var e=new c.b(16777215,.3),o=new c.m(16777215,.9);o.position.set(1,2,3),r.world.add(e),r.world.add(o);var n=new c.T(16,16,1,1),h=new c.K({map:t,side:c.n}),l=new c.J(n,h);l.scale.set(.1,.1,.1),r.world.add(l);n=new c.e(20,20,5,1,1,1),h=new c.L({color:16777215});var d=new c.J(n,h);d.scale.set(.1,.1,.1),r.world.add(d),d.position.z=-.3,r.world.camera.position.y=0,r.world.scene.fog=new c.u(0,.2),(new w.a).load("assets/fbx/info.fbx",(function(object){object.scale.set(.00225,.00225,.00225),object.rotation.x=.5*Math.PI,object.position.y=-1.35,object.traverse((function(t){t.isMesh&&(t.castShadow=!0,t.receiveShadow=!0)})),r.world.add(object)})),function t(){window.requestAnimationFrame(t);var e=.001*(new Date).getTime(),o=1.8*Math.cos(.25*e),n=1.5*Math.sin(.089*e);r.world.camera.position.x=o,r.world.camera.position.y=n}()}),void 0,(function(t){console.log(t)}))}r=this;window.addEventListener("resize",(function(){r.resize()}))}return Object(r.a)(t,[{key:"init",value:function(){this.world=new d(this.props.$canvas,this.props.$bgColor,!0),this.world.renderStart();var t=new c.T(1e3,1e3,1,1);t.rotateX(.5*-Math.PI);var e=new c.K({transparent:!0,opacity:0,wireframe:!0});this.surface=new c.J(t,e),this.world.add(this.surface),this.raycaster=new c.bb,this.tapPosition=new c.ob,this.world.focalLengthToFOV(28),this.world.camera.position.y=1.6,this.world.camera.position.z=3,this.world.focus=new c.pb(0,0,0)}},{key:"setUp",value:function(){var t=new v;this.scene=t,this.world.scene.add(this.scene.scene);var e=this;this.props.$canvas.addEventListener("touchstart",(function(o){var n=new c.ob;if(n.x=o.touches[0].pageX,n.y=o.touches[0].pageY,o.touches.length,!(o.touches.length>2)){e.tapPosition.x=o.touches[0].clientX/window.innerWidth*2-1,e.tapPosition.y=-o.touches[0].clientY/window.innerHeight*2+1,e.raycaster.setFromCamera(e.tapPosition,e.world.camera);var r=e.raycaster.intersectObject(e.surface);1==r.length&&r[0].object==e.surface&&t.fire(n,e.video,r[0].point.x,r[0].point.y,r[0].point.z)}})),this.props.$canvas.addEventListener("touchmove",(function(o){var n=new c.ob;if(n.x=o.touches[0].pageX,n.y=o.touches[0].pageY,o.touches.length,!(o.touches.length>2)){e.tapPosition.x=o.touches[0].clientX/window.innerWidth*2-1,e.tapPosition.y=-o.touches[0].clientY/window.innerHeight*2+1,e.raycaster.setFromCamera(e.tapPosition,e.world.camera);var r=e.raycaster.intersectObject(e.surface);1==r.length&&r[0].object==e.surface&&t.fire(n,e.video,r[0].point.x,r[0].point.y,r[0].point.z)}}))}},{key:"addVideo",value:function(){var t=window.innerWidth,e=window.innerHeight;this.video=this.props.$video,this.video.style.width=window.innerWidth+"px",this.video.style.height=window.innerHeight+"px",this.video.width=window.innerWidth,this.video.height=window.innerHeight,this.video.autoplay=!0;var o=this,n=navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:{exact:"environment"},aspectRatio:e/t}});n.then((function(t){o.video.srcObject=t})),n.catch((function(t){alert("Camera And Video Settimg Error.\n設定をしてもらってリロードを促す。")}))}},{key:"addDeviceOrientationControls",value:function(t){this.props.$button.removeEventListener("mousedown",this.addDeviceOrientationControls),this.world.addDeviceOrientationControls(),this.props.$button.setAttribute("style","display:none;"),document.querySelector(".message").className="message show",this.setUp()}},{key:"placeObjectTouchHandler",value:function(t){if(t.touches.length,!(t.touches.length>2)){this.tapPosition.x=t.touches[0].clientX/window.innerWidth*2-1,this.tapPosition.y=-t.touches[0].clientY/window.innerHeight*2+1,this.raycaster.setFromCamera(this.tapPosition,this.world.camera);var e=this.raycaster.intersectObject(this.surface);1==e.length&&e[0].object==this.surface&&this.placeObject(e[0].point.x,e[0].point.y,e[0].point.z)}}},{key:"placeObject",value:function(t,e,o){var n=new c.x(1,1),r=new c.K({wireframe:!0,transparent:!0,color:new c.k(Math.random(),Math.random(),Math.random())}),h=new c.J(n,r);h.position.set(t,e,o),h.rotation.x=Math.random()*Math.PI*2,h.rotation.y=Math.random()*Math.PI*2,this.world.add(h),h.scale.set(.01,.01,.01)}},{key:"loop",value:function(){var t=this;this.loopKey=window.requestAnimationFrame((function(){t.loop()}))}},{key:"resize",value:function(t){this.props.$video.style.width=window.innerWidth+"px",this.props.$video.style.height=window.innerHeight+"px"}},{key:"addEvents",value:function(){}},{key:"removeEvents",value:function(){}},{key:"dispose",value:function(){this.loopKey=window.cancelAnimationFrame(this.loopKey),this.removeEvents(),this.world.remove(this.surface),this.surface=null,this.world.dispose(),this.world=null,this.props=null,this.video=null,this.raycaster=null,this.tapPosition=null}}]),t}(),f={name:"artwork",components:{},props:[],data:function(){return{}},computed:{},mounted:function(){this.artworkGL=new m({$canvas:this.$refs.canvas,$bgColor:526344,$video:this.$refs.video,$button:this.$refs.button})},destroyed:function(){},methods:{}},y=(o(199),o(30)),k={components:{Artwork:Object(y.a)(f,(function(){var t=this.$createElement,e=this._self._c||t;return e("section",{staticClass:"artwork"},[e("video",{ref:"video",staticClass:"artwork__video",attrs:{autoplay:"",playsinline:"true"}}),this._v(" "),e("canvas",{ref:"canvas",staticClass:"artwork__canvas"}),this._v(" "),e("button",{ref:"button",staticClass:"artwork__button"},[this._v("WebARモードをONにする")])])}),[],!1,null,null,null).exports}},x=(o(201),Object(y.a)(k,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"container"},[e("div",[e("Artwork"),this._v(" "),e("h1",{staticClass:"title"},[this._v("WebAR")]),this._v(" "),e("h2",{staticClass:"description"},[this._v("original webar libs. sp only.")]),this._v(" "),this._m(0)],1)])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("p",{staticClass:"message"},[this._v("画面をタップ、フリックして"),e("br"),this._v("ロケットを打ち上げよう！")])}],!1,null,null,null));e.default=x.exports}}]);