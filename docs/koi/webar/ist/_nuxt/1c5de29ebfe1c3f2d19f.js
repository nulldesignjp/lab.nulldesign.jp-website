(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{184:function(t,e,n){var content=n(201);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(63).default)("31b988b4",content,!0,{sourceMap:!1})},185:function(t,e,n){var content=n(203);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(63).default)("6759f5ab",content,!0,{sourceMap:!1})},200:function(t,e,n){"use strict";var o=n(184);n.n(o).a},201:function(t,e,n){(e=n(62)(!1)).push([t.i,".artwork{z-index:-1}.artwork,.artwork__canvas,.artwork__video{position:fixed;left:0;top:0;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.artwork__canvas,.artwork__video{display:block;z-index:-2}.artwork__video{-o-object-fit:fill;object-fit:fill}.artwork__button{position:fixed;left:50%;top:50%;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:2;font-size:1.2em;width:320px;height:128px;margin:-64px 0 0 -160px;border:1px solid hsla(0,0%,100%,.6);border-radius:8px;background:hsla(0,0%,100%,.6);box-shadow:0 0 16px rgba(0,0,0,.1)}.artwork__button.hide,.hide{display:none}",""]),t.exports=e},202:function(t,e,n){"use strict";var o=n(185);n.n(o).a},203:function(t,e,n){(e=n(62)(!1)).push([t.i,"body,html{overflow:hidden;font-family:Heebo}body{background:#000}.title{margin:16px 16px 0;padding:4px 4px 0}.description,.title{line-height:1;font-weight:400;background:hsla(0,0%,100%,.2);font-weight:100;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.description{margin:0 16px;padding:0 4px 4px;font-size:1em}.message{position:fixed;bottom:8px;left:0;width:100%;margin:0;padding:4px 4px 0;line-height:1;font-weight:400;background:hsla(0,0%,100%,.4);font-weight:100;display:none;text-align:center}.message.show{display:block}",""]),t.exports=e},207:function(t,e,n){"use strict";n.r(e);var o=n(178),r=n(179),h=n(177),c=(n(20),n(21),n(13),n(192),n(204),n(205),n(206),n(186),n(187),n(194),n(182),n(195),n(188),n(196)),l=n(197);var d=function(){function t(e,n,r){Object(o.a)(this,t);var h=this;this.scene,this.camera,this.focus,this.renderer,this.mode,this.clock,this.time,this.timeScale,this.animationKey,this.controls,this.raycaster,this.composer,n=null==n?16777215:n,this.mode=null==r?0:r,this.init(e,n,this.mode),window.addEventListener("resize",(function(){h.resize()})),this.resize()}return Object(r.a)(t,[{key:"init",value:function(t,e,n){this.clock=new h.k,this.time=0;var o=window.innerWidth,r=window.innerHeight;this.scene=new h.gb,this.camera=new h.U(60,o/r,.01,1e3),this.camera.position.set(0,0,500),this.focus=new h.sb(0,0,0),this.renderer=new h.wb({antialias:!0,canvas:t,alpha:!0}),this.renderer.setSize(o,r),this.renderer.setClearColor(e),this.renderer.autoClearColor=!1,this.renderer.autoClear=!1,this.renderer.render(this.scene,this.camera),this.raycaster=new h.eb}},{key:"render",value:function(){var t=this;this.animationKey=window.requestAnimationFrame((function(){t.render()}));var e=this.clock.getDelta();this.time+=e*this.timeScale,null!=this.controls&&(0==this.controls.alphaOffset&&0!=this.camera.rotation.y&&(this.controls.alphaOffset=-1*this.camera.rotation.y),this.controls.update()),this.renderer.render(this.scene,this.camera)}},{key:"resize",value:function(){console.log("resize....");var t=window.innerWidth,e=window.innerHeight;this.renderer.setSize(t,e),this.camera.aspect?this.camera.aspect=t/e:(this.camera.left=.5*-t,this.camera.right=.5*t,this.camera.bottom=.5*-e,this.camera.top=.5*e),this.camera.updateProjectionMatrix()}},{key:"getWorldToScreen2D",value:function(t){var e=new h.sb,n=this.renderer.getContext(),o=.5*n.canvas.width,r=.5*n.canvas.height;t.updateMatrixWorld(),e.setFromMatrixPosition(t.matrixWorld),e.project(this.camera),e.x=e.x*o+o,e.y=-e.y*r+r;var c=(new h.sb).subVectors(this.focus,this.camera.position),l=(new h.sb).subVectors(t.position,this.camera.position);return c.dot(l)<=0&&(e.x=-9999,e.y=-9999),{x:e.x,y:e.y}}},{key:"focalLengthToFOV",value:function(t){var e=this.camera.filmGauge,n=2*e/3,o=Math.sqrt(e*e+n*n);this.camera.fov=180/Math.PI*Math.atan(o/(2*t))*2,this.camera.updateProjectionMatrix()}},{key:"pixelEqualMagnification",value:function(){return.5*window.innerHeight/Math.tan(.5*_world.camera.fov*Math.PI/180)}},{key:"add",value:function(t){this.scene.add(t)}},{key:"remove",value:function(t){if(t.geometry.dispose(),null!=t.material.uniforms)for(var i in null!=t.material.uniforms.value.dispose)t.material.uniforms[i].value.dispose();null!=t.material.map&&t.material.map.dispose(),this.scene.remove(t)}},{key:"renderStart",value:function(){this.renderStop(),this.clock.start(),this.render(0)}},{key:"renderStop",value:function(){window.cancelAnimationFrame(this.animationKey),this.clock.stop()}},{key:"addOrbitControls",value:function(){this.controls=new l.a(this.camera,this.renderer.domElement),this.controls.autoRotate=!1,this.controls.autoRotateSpeed=.2,this.controls.enableDamping=!0,this.controls.dampingFactor=.15,this.controls.enableZoom=!0,this.controls.enabled=!0,this.controls.target=this.focus}},{key:"addDeviceOrientationControls",value:function(){this.controls=new c.a(this.camera),this.controls.connect()}},{key:"addDevicemotion",value:function(t){}},{key:"dispose",value:function(){this.renderStop(),this.scene.dispose(),this.renderer.dispose(),this.controls.dispose(),this.scene=null,this.renderer=null,this.controls=null,this.camera=null,this.focus=null,this.clock=null,this.time=null,this.timeScale=null,this.animationKey=null,this.raycaster=null,this.composer=null}}]),t}(),w=(n(198),n(180)),m=n(183),v=(n(22),n(199),function(){function t(e){Object(o.a)(this,t),this.props=e,this.cannon,this.scene,this.clock,this.delta,this.time,this.loopKey,this.objects,this.texture,this.texture2,this.isIST,this.init()}return Object(r.a)(t,[{key:"init",value:function(){this.scene=new h.gb,this.clock=new h.k,console.log(this.scene),this.objects=[],this.isIST=!0;var t=new h.b(16777215,.6),e=new h.n(16777215,.8);e.position.set(1,1,1),this.scene.add(t),this.scene.add(e),this.cannon=new m.World,this.cannon.broadphase=new m.NaiveBroadphase,this.cannon.gravity.set(0,-9.8,0),this.cannon.solver.tolerance=.001;var n=new m.Body({mass:0}),o=new m.Plane;n.addShape(o),n.quaternion.setFromAxisAngle(new m.Vec3(1,0,0),-Math.PI/2),this.cannon.addBody(n);var r=this;(new h.ob).load("assets/img/box.jpg",(function(t){r.texture=t}),void 0,(function(t){})),(new h.ob).load("assets/img/box2.jpg",(function(t){r.texture2=t}),void 0,(function(t){}));this.update()}},{key:"fire",value:function(t,e,n,o,r){for(var c=new h.sb(n,o,r),l=this.objects.length,d=!0;l;){if(l--,(w=this.objects[l].mesh).position.distanceTo(c)<.1){d=!1;break}}if(d){var w,v=new h.sb(1024,1024,1024).multiplyScalar(1e-4),f=new h.f(3*v.x,3*v.y,3*v.z),y=new h.O({map:this.texture,color:16777215});(w=new h.M(f,y)).position.set(n,o+5+3*Math.random(),r),this.scene.add(w);var x=new m.Material,k=new m.Body({material:x,mass:5,position:new m.Vec3(n,o+5+3*Math.random(),r),shape:new m.Box(new m.Vec3(3*v.x*.5,3*v.y*.5,3*v.z*.5))});if(k.linearDamping=.01,this.cannon.addBody(k),k.quaternion.x=Math.random(),k.quaternion.y=Math.random(),k.quaternion.z=Math.random(),this.objects.push({mesh:w,body:k,life:this.time}),(l=this.objects.length)>100){var M=this.objects.shift();this.scene.remove(M.mesh),M.mesh.geometry.dispose(),M.mesh.material.map.dispose(),M.mesh.material.dispose(),this.cannon.removeBody(M.body)}}}},{key:"doubleTap",value:function(){this.isIST=!this.isIST;for(var t=this.objects.length;t;){t--;var e=this.objects[t].mesh,n=this.objects[t].body;n.velocity.y+=5*Math.random(),n.angularVelocity.x+=(Math.random()-.5)*Math.PI*2,n.angularVelocity.y+=(Math.random()-.5)*Math.PI*2,n.angularVelocity.z+=(Math.random()-.5)*Math.PI*2,this.isIST?e.material.map=this.texture:e.material.map=this.texture2}}},{key:"update",value:function(){var t=this;this.loopKey=window.requestAnimationFrame((function(){t.update()})),this.delta=this.clock.getDelta(),this.time+=this.delta,this.cannon.step(1/60,this.delta,3);for(var e=this.objects.length;e;){e--;var n=this.objects[e].mesh,o=this.objects[e].body;if(n.position.copy(o.position),n.quaternion.copy(o.quaternion),n.position.y>20||this.time-this.objects[e].life>10){var r=this.objects.splice(e,1)[0];this.scene.remove(r.mesh),this.cannon.removeBody(r.body)}}}},{key:"resize",value:function(){}},{key:"start",value:function(){this.stop(),this.update(),this.clock.start()}},{key:"stop",value:function(){window.cancelAnimationFrame(this.loopKey),this.clock.stop()}},{key:"addEvents",value:function(){}},{key:"removeEvents",value:function(){}},{key:"dispose",value:function(){this.removeEvents(),this.stop()}}]),t}()),f=(n(190),function(){function t(e){Object(o.a)(this,t),this.props=e,this.world,this.scene,this.video,this.surface,this.raycaster,this.tapPosition,this.loopKey,this.isSP=!1;var n=navigator.userAgent.toLowerCase();-1==n.indexOf("iphone")&&-1==n.indexOf("ipad")&&-1==n.indexOf("android")||(this.isSP=!0),this.init(),this.loop();var r=this;if(this.isSP)this.addVideo(),this.props.$button.addEventListener("mousedown",(function(t){r.addDeviceOrientationControls(t)}));else{this.world.addOrbitControls(),this.props.$button.setAttribute("style","display:none;");var c="https://api.qrserver.com/v1/create-qr-code/?size=256x256&data="+location.href;(new h.ob).load(c,(function(t){var e=new h.b(16777215,.3),n=new h.n(16777215,.9);n.position.set(1,2,3),r.world.add(e),r.world.add(n);var o=new h.W(16,16,1,1),c=new h.N({map:t,side:h.o}),l=new h.M(o,c);l.scale.set(.1,.1,.1),r.world.add(l);o=new h.f(20,20,5,1,1,1),c=new h.O({color:16777215});var d=new h.M(o,c);d.scale.set(.1,.1,.1),r.world.add(d),d.position.z=-.3,r.world.camera.position.y=0,r.world.scene.fog=new h.w(0,.2),(new w.a).load("assets/fbx/info.fbx",(function(object){object.scale.set(.00225,.00225,.00225),object.rotation.x=.5*Math.PI,object.position.y=-1.35,object.traverse((function(t){t.isMesh&&(t.castShadow=!0,t.receiveShadow=!0)})),r.world.add(object)})),function t(){window.requestAnimationFrame(t);var e=.001*(new Date).getTime(),n=1.8*Math.cos(.25*e),o=1.5*Math.sin(.089*e);r.world.camera.position.x=n,r.world.camera.position.y=o}()}),void 0,(function(t){console.log(t)}))}r=this;window.addEventListener("resize",(function(){r.resize()}))}return Object(r.a)(t,[{key:"init",value:function(){this.world=new d(this.props.$canvas,this.props.$bgColor,!0),this.world.renderStart();var t=new h.W(1e3,1e3,1,1);t.rotateX(.5*-Math.PI);var e=new h.N({transparent:!0,opacity:0,wireframe:!0});this.surface=new h.M(t,e),this.world.add(this.surface),this.raycaster=new h.eb,this.tapPosition=new h.rb,this.world.focalLengthToFOV(28),this.world.camera.position.y=1.6,this.world.camera.position.z=3,this.world.focus=new h.sb(0,0,0)}},{key:"setUp",value:function(){var t=new v;this.scene=t,this.world.scene.add(this.scene.scene);var e=this;this.props.$canvas.addEventListener("touchstart",(function(n){var o=new h.rb;if(o.x=n.touches[0].pageX,o.y=n.touches[0].pageY,2==n.touches.length)return console.log("double tap"),void t.doubleTap();if(!(n.touches.length>2)){e.tapPosition.x=n.touches[0].clientX/window.innerWidth*2-1,e.tapPosition.y=-n.touches[0].clientY/window.innerHeight*2+1,e.raycaster.setFromCamera(e.tapPosition,e.world.camera);var r=e.raycaster.intersectObject(e.surface);1==r.length&&r[0].object==e.surface&&t.fire(o,e.video,r[0].point.x,r[0].point.y,r[0].point.z)}})),this.props.$canvas.addEventListener("touchmove",(function(n){var o=new h.rb;if(o.x=n.touches[0].pageX,o.y=n.touches[0].pageY,2!=n.touches.length&&!(n.touches.length>2)){e.tapPosition.x=n.touches[0].clientX/window.innerWidth*2-1,e.tapPosition.y=-n.touches[0].clientY/window.innerHeight*2+1,e.raycaster.setFromCamera(e.tapPosition,e.world.camera);var r=e.raycaster.intersectObject(e.surface);1==r.length&&r[0].object==e.surface&&t.fire(o,e.video,r[0].point.x,r[0].point.y,r[0].point.z)}}))}},{key:"addVideo",value:function(){var t=window.innerWidth,e=window.innerHeight;this.video=this.props.$video,this.video.style.width=window.innerWidth+"px",this.video.style.height=window.innerHeight+"px",this.video.width=window.innerWidth,this.video.height=window.innerHeight,this.video.autoplay=!0;var n=this,o=navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:{exact:"environment"},aspectRatio:e/t}});o.then((function(t){n.video.srcObject=t})),o.catch((function(t){alert("Camera And Video Settimg Error.\n設定をしてもらってリロードを促す。")}))}},{key:"addDeviceOrientationControls",value:function(t){this.props.$button.removeEventListener("mousedown",this.addDeviceOrientationControls),this.world.addDeviceOrientationControls(),this.props.$button.setAttribute("style","display:none;"),document.querySelector(".message").className="message show",this.setUp()}},{key:"placeObjectTouchHandler",value:function(t){if(t.touches.length,!(t.touches.length>2)){this.tapPosition.x=t.touches[0].clientX/window.innerWidth*2-1,this.tapPosition.y=-t.touches[0].clientY/window.innerHeight*2+1,this.raycaster.setFromCamera(this.tapPosition,this.world.camera);var e=this.raycaster.intersectObject(this.surface);1==e.length&&e[0].object==this.surface&&this.placeObject(e[0].point.x,e[0].point.y,e[0].point.z)}}},{key:"placeObject",value:function(t,e,n){var o=new h.z(1,1),r=new h.N({wireframe:!0,transparent:!0,color:new h.l(Math.random(),Math.random(),Math.random())}),c=new h.M(o,r);c.position.set(t,e,n),c.rotation.x=Math.random()*Math.PI*2,c.rotation.y=Math.random()*Math.PI*2,this.world.add(c),c.scale.set(.01,.01,.01)}},{key:"loop",value:function(){var t=this;this.loopKey=window.requestAnimationFrame((function(){t.loop()}))}},{key:"resize",value:function(t){this.props.$video.style.width=window.innerWidth+"px",this.props.$video.style.height=window.innerHeight+"px"}},{key:"addEvents",value:function(){}},{key:"removeEvents",value:function(){}},{key:"dispose",value:function(){this.loopKey=window.cancelAnimationFrame(this.loopKey),this.removeEvents(),this.world.remove(this.surface),this.surface=null,this.world.dispose(),this.world=null,this.props=null,this.video=null,this.raycaster=null,this.tapPosition=null}}]),t}()),y={name:"artwork",components:{},props:[],data:function(){return{}},computed:{},mounted:function(){this.artworkGL=new f({$canvas:this.$refs.canvas,$bgColor:526344,$video:this.$refs.video,$button:this.$refs.button})},destroyed:function(){},methods:{}},x=(n(200),n(30)),k={components:{Artwork:Object(x.a)(y,(function(){var t=this.$createElement,e=this._self._c||t;return e("section",{staticClass:"artwork"},[e("video",{ref:"video",staticClass:"artwork__video",attrs:{autoplay:"",playsinline:"true"}}),this._v(" "),e("canvas",{ref:"canvas",staticClass:"artwork__canvas"}),this._v(" "),e("button",{ref:"button",staticClass:"artwork__button"},[this._v("WebARモードをONにする")])])}),[],!1,null,null,null).exports}},M=(n(202),Object(x.a)(k,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"container"},[e("div",[e("Artwork"),this._v(" "),e("h1",{staticClass:"title"},[this._v("WebAR")]),this._v(" "),e("h2",{staticClass:"description"},[this._v("original webar libs. sp only.")]),this._v(" "),this._m(0)],1)])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("p",{staticClass:"message"},[this._v(" "),e("br"),this._v(" ")])}],!1,null,null,null));e.default=M.exports}}]);