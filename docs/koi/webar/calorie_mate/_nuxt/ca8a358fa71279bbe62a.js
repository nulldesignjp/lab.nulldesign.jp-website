(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{182:function(e,t,n){var content=n(200);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(63).default)("31b988b4",content,!0,{sourceMap:!1})},183:function(e,t,n){var content=n(202);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(63).default)("6759f5ab",content,!0,{sourceMap:!1})},199:function(e,t,n){"use strict";var o=n(182);n.n(o).a},200:function(e,t,n){(t=n(62)(!1)).push([e.i,".artwork{z-index:-1}.artwork,.artwork__canvas,.artwork__video{position:fixed;left:0;top:0;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.artwork__canvas,.artwork__video{display:block;z-index:-2}.artwork__video{-o-object-fit:fill;object-fit:fill}.artwork__button{position:fixed;left:50%;top:50%;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:2;font-size:1.2em;width:320px;height:128px;margin:-64px 0 0 -160px;border:1px solid hsla(0,0%,100%,.6);border-radius:8px;background:hsla(0,0%,100%,.6);box-shadow:0 0 16px rgba(0,0,0,.1)}.artwork__button.hide,.hide{display:none}",""]),e.exports=t},201:function(e,t,n){"use strict";var o=n(183);n.n(o).a},202:function(e,t,n){(t=n(62)(!1)).push([e.i,"body,html{overflow:hidden;font-family:Heebo}body{background:#000}.title{margin:16px 16px 0;padding:4px 4px 0}.description,.title{line-height:1;font-weight:400;background:hsla(0,0%,100%,.2);font-weight:100;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.description{margin:0 16px;padding:0 4px 4px;font-size:1em}.message{position:fixed;bottom:8px;left:0;width:100%;margin:0;padding:4px 4px 0;line-height:1;font-weight:400;background:hsla(0,0%,100%,.4);font-weight:100;display:none;text-align:center}.message.show{display:block}",""]),e.exports=t},206:function(e,t,n){"use strict";n.r(t);var o=n(178),r=n(179),c=n(177),h=(n(20),n(21),n(13),n(191),n(203),n(204),n(205),n(184),n(185),n(193),n(181),n(194),n(186),n(195)),l=n(196);var d=function(){function e(t,n,r){Object(o.a)(this,e);var c=this;this.scene,this.camera,this.focus,this.renderer,this.mode,this.clock,this.time,this.timeScale,this.animationKey,this.controls,this.raycaster,this.composer,n=null==n?16777215:n,this.mode=null==r?0:r,this.init(t,n,this.mode),window.addEventListener("resize",(function(){c.resize()})),this.resize()}return Object(r.a)(e,[{key:"init",value:function(e,t,n){this.clock=new c.j,this.time=0;var o=window.innerWidth,r=window.innerHeight;this.scene=new c.db,this.camera=new c.R(60,o/r,.01,1e3),this.camera.position.set(0,0,500),this.focus=new c.pb(0,0,0),this.renderer=new c.tb({antialias:!0,canvas:e,alpha:!0}),this.renderer.setSize(o,r),this.renderer.setClearColor(t),this.renderer.autoClearColor=!1,this.renderer.autoClear=!1,this.renderer.render(this.scene,this.camera),this.raycaster=new c.bb}},{key:"render",value:function(){var e=this;this.animationKey=window.requestAnimationFrame((function(){e.render()}));var t=this.clock.getDelta();this.time+=t*this.timeScale,null!=this.controls&&(0==this.controls.alphaOffset&&0!=this.camera.rotation.y&&(this.controls.alphaOffset=-1*this.camera.rotation.y),this.controls.update()),this.renderer.render(this.scene,this.camera)}},{key:"resize",value:function(){console.log("resize....");var e=window.innerWidth,t=window.innerHeight;this.renderer.setSize(e,t),this.camera.aspect?this.camera.aspect=e/t:(this.camera.left=.5*-e,this.camera.right=.5*e,this.camera.bottom=.5*-t,this.camera.top=.5*t),this.camera.updateProjectionMatrix()}},{key:"getWorldToScreen2D",value:function(e){var t=new c.pb,n=this.renderer.getContext(),o=.5*n.canvas.width,r=.5*n.canvas.height;e.updateMatrixWorld(),t.setFromMatrixPosition(e.matrixWorld),t.project(this.camera),t.x=t.x*o+o,t.y=-t.y*r+r;var h=(new c.pb).subVectors(this.focus,this.camera.position),l=(new c.pb).subVectors(e.position,this.camera.position);return h.dot(l)<=0&&(t.x=-9999,t.y=-9999),{x:t.x,y:t.y}}},{key:"focalLengthToFOV",value:function(e){var t=this.camera.filmGauge,n=2*t/3,o=Math.sqrt(t*t+n*n);this.camera.fov=180/Math.PI*Math.atan(o/(2*e))*2,this.camera.updateProjectionMatrix()}},{key:"pixelEqualMagnification",value:function(){return.5*window.innerHeight/Math.tan(.5*_world.camera.fov*Math.PI/180)}},{key:"add",value:function(e){this.scene.add(e)}},{key:"remove",value:function(e){if(e.geometry.dispose(),null!=e.material.uniforms)for(var i in null!=e.material.uniforms.value.dispose)e.material.uniforms[i].value.dispose();null!=e.material.map&&e.material.map.dispose(),this.scene.remove(e)}},{key:"renderStart",value:function(){this.renderStop(),this.clock.start(),this.render(0)}},{key:"renderStop",value:function(){window.cancelAnimationFrame(this.animationKey),this.clock.stop()}},{key:"addOrbitControls",value:function(){this.controls=new l.a(this.camera,this.renderer.domElement),this.controls.autoRotate=!1,this.controls.autoRotateSpeed=.2,this.controls.enableDamping=!0,this.controls.dampingFactor=.15,this.controls.enableZoom=!0,this.controls.enabled=!0,this.controls.target=this.focus}},{key:"addDeviceOrientationControls",value:function(){this.controls=new h.a(this.camera),this.controls.connect()}},{key:"addDevicemotion",value:function(e){}},{key:"dispose",value:function(){this.renderStop(),this.scene.dispose(),this.renderer.dispose(),this.controls.dispose(),this.scene=null,this.renderer=null,this.controls=null,this.camera=null,this.focus=null,this.clock=null,this.time=null,this.timeScale=null,this.animationKey=null,this.raycaster=null,this.composer=null}}]),e}(),w=(n(197),n(187)),v=n(189),m=(n(22),n(198),function(){function e(t){Object(o.a)(this,e),this.props=t,this.cannon,this.scene,this.clock,this.delta,this.time,this.loopKey,this.objects,this.texture,this.init()}return Object(r.a)(e,[{key:"init",value:function(){this.scene=new c.db,this.clock=new c.j,console.log(this.scene),this.objects=[];var e=new c.b(16777215,.4),t=new c.m(16777215,.6);t.position.set(1,1,1),this.scene.add(e),this.scene.add(t),this.cannon=new v.World,this.cannon.broadphase=new v.NaiveBroadphase,this.cannon.gravity.set(0,-9.8,0),this.cannon.solver.tolerance=.001;var n=new v.Body({mass:0}),o=new v.Plane;n.addShape(o),n.quaternion.setFromAxisAngle(new v.Vec3(1,0,0),-Math.PI/2),this.cannon.addBody(n);var r=this;(new c.lb).load("assets/img/81wAWBcWfyL._AC_SX425_.jpg",(function(e){r.texture=e}),void 0,(function(e){}));this.update()}},{key:"fire",value:function(e,t,n,o,r){for(var h=new c.pb(n,o,r),l=this.objects.length,d=!0;l;){if(l--,(w=this.objects[l].mesh).position.distanceTo(h)<.1){d=!1;break}}if(d){var w,m=new c.e(.06,.1*3,.321),f=new c.L({map:this.texture,color:16498964});(w=new c.J(m,f)).position.set(n,o+5,r),this.scene.add(w);var y=new v.Material,k=new v.Body({material:y,mass:5,position:new v.Vec3(n,o+5,r),shape:new v.Box(new v.Vec3(.03,.1*3*.5,.1605))});if(k.linearDamping=.01,this.cannon.addBody(k),k.quaternion.x=Math.random(),k.quaternion.y=Math.random(),k.quaternion.z=Math.random(),this.objects.push({mesh:w,body:k,life:this.time}),(l=this.objects.length)>100){var x=this.objects.shift();this.scene.remove(x.mesh),x.mesh.geometry.dispose(),x.mesh.material.map.dispose(),x.mesh.material.dispose(),this.cannon.removeBody(x.body)}}}},{key:"update",value:function(){var e=this;this.loopKey=window.requestAnimationFrame((function(){e.update()})),this.delta=this.clock.getDelta(),this.time+=this.delta,this.cannon.step(1/60,this.delta,3);for(var t=this.objects.length;t;){t--;var n=this.objects[t].mesh,o=this.objects[t].body;if(n.position.copy(o.position),n.quaternion.copy(o.quaternion),n.position.y>20||this.time-this.objects[t].life>10){var r=this.objects.splice(t,1)[0];this.scene.remove(r.mesh),this.cannon.removeBody(r.body)}}}},{key:"resize",value:function(){}},{key:"start",value:function(){this.stop(),this.update(),this.clock.start()}},{key:"stop",value:function(){window.cancelAnimationFrame(this.loopKey),this.clock.stop()}},{key:"addEvents",value:function(){}},{key:"removeEvents",value:function(){}},{key:"dispose",value:function(){this.removeEvents(),this.stop()}}]),e}()),f=function(){function e(t){Object(o.a)(this,e),this.props=t,this.world,this.scene,this.video,this.surface,this.raycaster,this.tapPosition,this.loopKey,this.isSP=!1;var n=navigator.userAgent.toLowerCase();-1==n.indexOf("iphone")&&-1==n.indexOf("ipad")&&-1==n.indexOf("android")||(this.isSP=!0),this.init(),this.loop();var r=this;if(this.isSP)this.addVideo(),this.props.$button.addEventListener("mousedown",(function(e){r.addDeviceOrientationControls(e)}));else{this.world.addOrbitControls(),this.props.$button.setAttribute("style","display:none;");var h="https://api.qrserver.com/v1/create-qr-code/?size=256x256&data="+location.href;(new c.lb).load(h,(function(e){var t=new c.b(16777215,.3),n=new c.m(16777215,.9);n.position.set(1,2,3),r.world.add(t),r.world.add(n);var o=new c.T(16,16,1,1),h=new c.K({map:e,side:c.n}),l=new c.J(o,h);l.scale.set(.1,.1,.1),r.world.add(l);o=new c.e(20,20,5,1,1,1),h=new c.L({color:16777215});var d=new c.J(o,h);d.scale.set(.1,.1,.1),r.world.add(d),d.position.z=-.3,r.world.camera.position.y=0,r.world.scene.fog=new c.u(0,.2),(new w.a).load("assets/fbx/info.fbx",(function(object){object.scale.set(.00225,.00225,.00225),object.rotation.x=.5*Math.PI,object.position.y=-1.35,object.traverse((function(e){e.isMesh&&(e.castShadow=!0,e.receiveShadow=!0)})),r.world.add(object)})),function e(){window.requestAnimationFrame(e);var t=.001*(new Date).getTime(),n=1.8*Math.cos(.25*t),o=1.5*Math.sin(.089*t);r.world.camera.position.x=n,r.world.camera.position.y=o}()}),void 0,(function(e){console.log(e)}))}r=this;window.addEventListener("resize",(function(){r.resize()}))}return Object(r.a)(e,[{key:"init",value:function(){this.world=new d(this.props.$canvas,this.props.$bgColor,!0),this.world.renderStart();var e=new c.T(1e3,1e3,1,1);e.rotateX(.5*-Math.PI);var t=new c.K({transparent:!0,opacity:0,wireframe:!0});this.surface=new c.J(e,t),this.world.add(this.surface),this.raycaster=new c.bb,this.tapPosition=new c.ob,this.world.focalLengthToFOV(28),this.world.camera.position.y=1.6,this.world.camera.position.z=3,this.world.focus=new c.pb(0,0,0)}},{key:"setUp",value:function(){var e=new m;this.scene=e,this.world.scene.add(this.scene.scene);var t=this;this.props.$canvas.addEventListener("touchstart",(function(n){var o=new c.ob;if(o.x=n.touches[0].pageX,o.y=n.touches[0].pageY,n.touches.length,!(n.touches.length>2)){t.tapPosition.x=n.touches[0].clientX/window.innerWidth*2-1,t.tapPosition.y=-n.touches[0].clientY/window.innerHeight*2+1,t.raycaster.setFromCamera(t.tapPosition,t.world.camera);var r=t.raycaster.intersectObject(t.surface);1==r.length&&r[0].object==t.surface&&e.fire(o,t.video,r[0].point.x,r[0].point.y,r[0].point.z)}})),this.props.$canvas.addEventListener("touchmove",(function(n){var o=new c.ob;if(o.x=n.touches[0].pageX,o.y=n.touches[0].pageY,n.touches.length,!(n.touches.length>2)){t.tapPosition.x=n.touches[0].clientX/window.innerWidth*2-1,t.tapPosition.y=-n.touches[0].clientY/window.innerHeight*2+1,t.raycaster.setFromCamera(t.tapPosition,t.world.camera);var r=t.raycaster.intersectObject(t.surface);1==r.length&&r[0].object==t.surface&&e.fire(o,t.video,r[0].point.x,r[0].point.y,r[0].point.z)}}))}},{key:"addVideo",value:function(){var e=window.innerWidth,t=window.innerHeight;this.video=this.props.$video,this.video.style.width=window.innerWidth+"px",this.video.style.height=window.innerHeight+"px",this.video.width=window.innerWidth,this.video.height=window.innerHeight,this.video.autoplay=!0;var n=this,o=navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:{exact:"environment"},aspectRatio:t/e}});o.then((function(e){n.video.srcObject=e})),o.catch((function(e){alert("Camera And Video Settimg Error.\n設定をしてもらってリロードを促す。")}))}},{key:"addDeviceOrientationControls",value:function(e){this.props.$button.removeEventListener("mousedown",this.addDeviceOrientationControls),this.world.addDeviceOrientationControls(),this.props.$button.setAttribute("style","display:none;"),document.querySelector(".message").className="message show",this.setUp()}},{key:"placeObjectTouchHandler",value:function(e){if(e.touches.length,!(e.touches.length>2)){this.tapPosition.x=e.touches[0].clientX/window.innerWidth*2-1,this.tapPosition.y=-e.touches[0].clientY/window.innerHeight*2+1,this.raycaster.setFromCamera(this.tapPosition,this.world.camera);var t=this.raycaster.intersectObject(this.surface);1==t.length&&t[0].object==this.surface&&this.placeObject(t[0].point.x,t[0].point.y,t[0].point.z)}}},{key:"placeObject",value:function(e,t,n){var o=new c.x(1,1),r=new c.K({wireframe:!0,transparent:!0,color:new c.k(Math.random(),Math.random(),Math.random())}),h=new c.J(o,r);h.position.set(e,t,n),h.rotation.x=Math.random()*Math.PI*2,h.rotation.y=Math.random()*Math.PI*2,this.world.add(h),h.scale.set(.01,.01,.01)}},{key:"loop",value:function(){var e=this;this.loopKey=window.requestAnimationFrame((function(){e.loop()}))}},{key:"resize",value:function(e){this.props.$video.style.width=window.innerWidth+"px",this.props.$video.style.height=window.innerHeight+"px"}},{key:"addEvents",value:function(){}},{key:"removeEvents",value:function(){}},{key:"dispose",value:function(){this.loopKey=window.cancelAnimationFrame(this.loopKey),this.removeEvents(),this.world.remove(this.surface),this.surface=null,this.world.dispose(),this.world=null,this.props=null,this.video=null,this.raycaster=null,this.tapPosition=null}}]),e}(),y={name:"artwork",components:{},props:[],data:function(){return{}},computed:{},mounted:function(){this.artworkGL=new f({$canvas:this.$refs.canvas,$bgColor:526344,$video:this.$refs.video,$button:this.$refs.button})},destroyed:function(){},methods:{}},k=(n(199),n(30)),x={components:{Artwork:Object(k.a)(y,(function(){var e=this.$createElement,t=this._self._c||e;return t("section",{staticClass:"artwork"},[t("video",{ref:"video",staticClass:"artwork__video",attrs:{autoplay:"",playsinline:"true"}}),this._v(" "),t("canvas",{ref:"canvas",staticClass:"artwork__canvas"}),this._v(" "),t("button",{ref:"button",staticClass:"artwork__button"},[this._v("WebARモードをONにする")])])}),[],!1,null,null,null).exports}},_=(n(201),Object(k.a)(x,(function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"container"},[t("div",[t("Artwork"),this._v(" "),t("h1",{staticClass:"title"},[this._v("WebAR")]),this._v(" "),t("h2",{staticClass:"description"},[this._v("original webar libs. sp only.")]),this._v(" "),this._m(0)],1)])}),[function(){var e=this.$createElement,t=this._self._c||e;return t("p",{staticClass:"message"},[this._v("画面をタップ、フリックして"),t("br"),this._v("カロリーメイトをゲットしよう！")])}],!1,null,null,null));t.default=_.exports}}]);