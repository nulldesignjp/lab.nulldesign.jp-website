<!doctype html>
<html>
<head>
<meta charset="UTF-8">
<meta http-equiv="Content-Language" content="ja">
<link href="https://fonts.googleapis.com/css?family=Heebo:100,400&display=swap&subset=hebrew" rel="stylesheet">
<title>hrsk.dev</title>
<style type="text/css">
html,body{	height:100%;}
body{background: #181818;color: #FFF;font-family:'Heebo';font-weight: 100;margin:0;padding:0;	overflow: hidden;}
a{color: #42affa;text-decoration: none;}
a:hover{color: #8dcffa;}
h1,h2,h3,h4,h5,h6{font-weight: normal;font-weight: 100;}
img{vertical-align: bottom;}
textarea{width:100%;height:100%;background: #181818;color:#FFF;border:none;font-family:'Heebo';font-weight: 100;}
</style>
</head>
<body>
<textarea id="ta">
京王電鉄 路線系統情報
https://api-tokyochallenge.odpt.org/api/v4/odpt:Railway?odpt:operator=odpt.Operator:Keio&acl:consumerKey=087a30246b2ff6af6f7199b7dc6c46d49e923067cc4b80969da7fffa886042cc

京王電鉄 駅情報
https://api-tokyochallenge.odpt.org/api/v4/odpt:Station?odpt:operator=odpt.Operator:Keio&acl:consumerKey=087a30246b2ff6af6f7199b7dc6c46d49e923067cc4b80969da7fffa886042cc



東京臨海高速鉄道 路線系統情報
https://api-tokyochallenge.odpt.org/api/v4/odpt:Railway?odpt:operator=odpt.Operator:TWR&acl:consumerKey=087a30246b2ff6af6f7199b7dc6c46d49e923067cc4b80969da7fffa886042cc

東京臨海高速鉄道 駅情報
https://api-tokyochallenge.odpt.org/api/v4/odpt:Station?odpt:operator=odpt.Operator:TWR&acl:consumerKey=087a30246b2ff6af6f7199b7dc6c46d49e923067cc4b80969da7fffa886042cc


JR東日本 路線系統情報
odpt.Railway:JR-East.ChuoRapid 中央線快速
odpt.Railway:JR-East.ChuoSobuLocal 中央・総武線各駅停車
odpt.Railway:JR-East.Hachiko 八高線
odpt.Railway:JR-East.Ito 伊東線
odpt.Railway:JR-East.Itsukaichi 五日市線
odpt.Railway:JR-East.Joban 常磐線(取手-坂元)
odpt.Railway:JR-East.JobanLocal 常磐線各駅停車
odpt.Railway:JR-East.JobanRapid 常磐線快速
odpt.Railway:JR-East.Kashima 鹿島線
odpt.Railway:JR-East.Kawagoe 川越線
odpt.Railway:JR-East.KeihinTohokuNegishi 京浜東北線・根岸線
odpt.Railway:JR-East.Keiyo 京葉線
odpt.Railway:JR-East.Kururi 久留里線
odpt.Railway:JR-East.Musashino 武蔵野線
odpt.Railway:JR-East.Nambu 南武線
odpt.Railway:JR-East.NambuBranch 南武線浜川崎支線
odpt.Railway:JR-East.Narita 成田線(佐倉-銚子)
odpt.Railway:JR-East.NaritaAbikoBranch 成田線我孫子支線
odpt.Railway:JR-East.NaritaAirportBranch 成田線空港支線
odpt.Railway:JR-East.Ome 青梅線
odpt.Railway:JR-East.Sagami 相模線
odpt.Railway:JR-East.SaikyoKawagoe 埼京線・川越線
odpt.Railway:JR-East.ShonanShinjuku 湘南新宿ライン
odpt.Railway:JR-East.Sobu 総武線
odpt.Railway:JR-East.SobuRapid 総武線快速
odpt.Railway:JR-East.Sotobo 外房線
odpt.Railway:JR-East.Takasaki 高崎線
odpt.Railway:JR-East.Togane 東金線
odpt.Railway:JR-East.Tokaido 東海道線(東京-熱海)
odpt.Railway:JR-East.Tsurumi 鶴見線
odpt.Railway:JR-East.TsurumiOkawaBranch 鶴見線大川支線
odpt.Railway:JR-East.TsurumiUmiShibauraBranch 鶴見線海芝浦支線
odpt.Railway:JR-East.Uchibo 内房線
odpt.Railway:JR-East.Utsunomiya 宇都宮線
odpt.Railway:JR-East.Yamanote 山手線
odpt.Railway:JR-East.Yokohama 横浜線
odpt.Railway:JR-East.Yokosuka 横須賀線

https://api-tokyochallenge.odpt.org/api/v4/odpt:Railway?odpt:operator=odpt.Operator:JR-East&acl:consumerKey=087a30246b2ff6af6f7199b7dc6c46d49e923067cc4b80969da7fffa886042cc

JR東日本 駅情報
https://api-tokyochallenge.odpt.org/api/v4/odpt:Station?odpt:operator=odpt.Operator:JR-East&acl:consumerKey=087a30246b2ff6af6f7199b7dc6c46d49e923067cc4b80969da7fffa886042cc



京急電鉄 路線系統情報
https://api-tokyochallenge.odpt.org/api/v4/odpt:Railway?odpt:operator=odpt.Operator:Keikyu&acl:consumerKey=087a30246b2ff6af6f7199b7dc6c46d49e923067cc4b80969da7fffa886042cc

京急電鉄 駅情報
https://api-tokyochallenge.odpt.org/api/v4/odpt:Station?odpt:operator=odpt.Operator:Keikyu&acl:consumerKey=087a30246b2ff6af6f7199b7dc6c46d49e923067cc4b80969da7fffa886042cc



京成電鉄 路線系統情報 
https://api-tokyochallenge.odpt.org/api/v4/odpt:Railway?odpt:operator=odpt.Operator:Keisei&acl:consumerKey=087a30246b2ff6af6f7199b7dc6c46d49e923067cc4b80969da7fffa886042cc

京成電鉄 駅情報
https://api-tokyochallenge.odpt.org/api/v4/odpt:Station?odpt:operator=odpt.Operator:Keisei&acl:consumerKey=087a30246b2ff6af6f7199b7dc6c46d49e923067cc4b80969da7fffa886042cc



小田急電鉄 路線系統情報
https://api-tokyochallenge.odpt.org/api/v4/odpt:Railway?odpt:operator=odpt.Operator:Odakyu&acl:consumerKey=087a30246b2ff6af6f7199b7dc6c46d49e923067cc4b80969da7fffa886042cc

小田急電鉄 駅情報
https://api-tokyochallenge.odpt.org/api/v4/odpt:Station?odpt:operator=odpt.Operator:Odakyu&acl:consumerKey=087a30246b2ff6af6f7199b7dc6c46d49e923067cc4b80969da7fffa886042cc



東急電鉄 路線系統情報
https://api-tokyochallenge.odpt.org/api/v4/odpt:Railway?odpt:operator=odpt.Operator:Tokyu&acl:consumerKey=087a30246b2ff6af6f7199b7dc6c46d49e923067cc4b80969da7fffa886042cc

東急電鉄 駅情報
https://api-tokyochallenge.odpt.org/api/v4/odpt:Station?odpt:operator=odpt.Operator:Tokyu&acl:consumerKey=087a30246b2ff6af6f7199b7dc6c46d49e923067cc4b80969da7fffa886042cc



横浜市交通局 路線系統情報 
https://api-tokyochallenge.odpt.org/api/v4/odpt:Railway?odpt:operator=odpt.Operator:YokohamaMunicipal&acl:consumerKey=087a30246b2ff6af6f7199b7dc6c46d49e923067cc4b80969da7fffa886042cc

横浜市交通局 駅情報
https://api-tokyochallenge.odpt.org/api/v4/odpt:Station?odpt:operator=odpt.Operator:YokohamaMunicipal&acl:consumerKey=087a30246b2ff6af6f7199b7dc6c46d49e923067cc4b80969da7fffa886042cc



東武鉄道 路線系統情報
https://api-tokyochallenge.odpt.org/api/v4/odpt:Railway?odpt:operator=odpt.Operator:Tobu&acl:consumerKey=087a30246b2ff6af6f7199b7dc6c46d49e923067cc4b80969da7fffa886042cc

東武鉄道 駅情報
https://api-tokyochallenge.odpt.org/api/v4/odpt:Station?odpt:operator=odpt.Operator:Tobu&acl:consumerKey=087a30246b2ff6af6f7199b7dc6c46d49e923067cc4b80969da7fffa886042cc



西武鉄道 路線系統情報
https://api-tokyochallenge.odpt.org/api/v4/odpt:Railway?odpt:operator=odpt.Operator:Seibu&acl:consumerKey=087a30246b2ff6af6f7199b7dc6c46d49e923067cc4b80969da7fffa886042cc

西武鉄道 駅情報
https://api-tokyochallenge.odpt.org/api/v4/odpt:Station?odpt:operator=odpt.Operator:Seibu&acl:consumerKey=087a30246b2ff6af6f7199b7dc6c46d49e923067cc4b80969da7fffa886042cc



ゆりかもめ 路線系統情報
https://api-tokyochallenge.odpt.org/api/v4/odpt:Railway?odpt:operator=odpt.Operator:Yurikamome&acl:consumerKey=087a30246b2ff6af6f7199b7dc6c46d49e923067cc4b80969da7fffa886042cc

ゆりかもめ 駅情報
https://api-tokyochallenge.odpt.org/api/v4/odpt:Station?odpt:operator=odpt.Operator:Yurikamome&acl:consumerKey=087a30246b2ff6af6f7199b7dc6c46d49e923067cc4b80969da7fffa886042cc
</textarea>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script type="text/javascript">
var _textarea = $('#ta');

//	site
//	https://ckan-tokyochallenge.odpt.org/dataset	

//	all	
//	https://ckan-tokyochallenge.odpt.org/dataset?organization=tokyometro

var _api = 'https://api-tokyochallenge.odpt.org/api/v4/';
var _access_token = '087a30246b2ff6af6f7199b7dc6c46d49e923067cc4b80969da7fffa886042cc';

//	odpt:railway: "odpt.Railway:TokyoMetro.Ginza"
//	odpt.Railway:TokyoMetro.Ginza, odpt.Calendar:Weekday
//	odpt.Railway:TokyoMetro.Ginza, odpt.Calendar:SaturdayHoliday

//	odpt:trainType: "odpt.TrainType:TokyoMetro.Local"
//	odpt:trainType: "odpt.TrainType:TokyoMetro.Rapid"
//	odpt:trainType: "odpt.TrainType:TokyoMetro.SemiExpress"
//	odpt:trainType: "odpt.TrainType:TokyoMetro.Express"
//	odpt:trainType: "odpt.TrainType:TokyoMetro.F-Liner"
//	odpt:trainType: "odpt.TrainType:TokyoMetro.CommuterExpress"

//	LOGO
//	https://dataodpt.blob.core.windows.net/files/TokyoMetro/Image/TokyoMetro.png?st=2019-11-13T03%3A58%3A14Z&se=2019-11-13T04%3A00%3A14Z&sp=r&sv=2018-03-28&sr=b&sig=%2BelPJmy2TdWDYTK%2FE2KrvCKxFXfV7sVkJ8TmdQXGvxI%3D


//	駅ナンバリング画像
//	https://api-tokyochallenge.odpt.org/api/v4/files/TokyoMetro/Image/StationNumber.zip?acl:consumerKey=087a30246b2ff6af6f7199b7dc6c46d49e923067cc4b80969da7fffa886042cc


$.ajax({
	url:
		_api + 'odpt:TrainInformation?odpt:operator=odpt.Operator:TokyoMetro&acl:consumerKey=' + _access_token,
	type: 'get',
	dataType: 'json',
	success: function( _json ){
		console.log( '東京メトロ 運行情報', _json );

	}
})

$.ajax({
	url:
		_api + 'odpt:PassengerSurvey?odpt:operator=odpt.Operator:TokyoMetro&acl:consumerKey=' + _access_token,
	type: 'get',
	dataType: 'json',
	success: function( _json ){
		console.log( '東京メトロ 乗降者数情報', _json );

	}
})

$.ajax({
	url:
		_api + 'odpt:Train?odpt:operator=odpt.Operator:TokyoMetro&acl:consumerKey=' + _access_token,
	type: 'get',
	dataType: 'json',
	success: function( _json ){
		console.log( '東京メトロ 列車ロケーション情報', _json );

	}
})


$.ajax({
	url:
		_api + 'odpt:Railway?odpt:operator=odpt.Operator:TokyoMetro&acl:consumerKey=' + _access_token,
	type: 'get',
	dataType: 'json',
	success: function( _json ){
		console.log( '東京メトロ 路線系統情報', _json );

	}
})

$.ajax({
	url:
		_api + 'odpt:RailwayFare?odpt:operator=odpt.Operator:TokyoMetro&acl:consumerKey=' + _access_token,
	type: 'get',
	dataType: 'json',
	success: function( _json ){
		console.log( '東京メトロ 運賃情報', _json );

	}
})

$.ajax({
	url:
		_api + 'odpt:Station?odpt:operator=odpt.Operator:TokyoMetro&acl:consumerKey=' + _access_token,
	type: 'get',
	dataType: 'json',
	success: function( _json ){
		_json = _json.sort(function( a, b ){
			if( a['odpt:stationCode'] > b['odpt:stationCode'] )
			{
				return 1;
			} else if( a['odpt:stationCode'] < b['odpt:stationCode'] )
			{
				return -1;
			}
			return 0;
		});

		console.log( '東京メトロ 駅情報', _json );

		var _index = 'C';

		var _t = _textarea.text();
		var len = _json.length;
		for( var i = 0; i < len; i++ )
		{
			var _key = _json[i]['odpt:stationCode'][0];
			if( _index != _key )
			{
				_index = _key;
				_t += '\n';
			}
			_t += _json[i]['odpt:stationCode'] + ':' + _json[i]['dc:title'] + ', '
		}

		_t += '\n\n';
		_textarea.text( _t );

	}
})

$.ajax({
	url:
		_api + 'odpt:StationTimetable?odpt:operator=odpt.Operator:TokyoMetro&acl:consumerKey=' + _access_token,
	type: 'get',
	dataType: 'json',
	success: function( _json ){
		console.log( '東京メトロ 駅時刻表', _json );

	}
})

/*
$.ajax({
	url:
		_api + 'odpt:TrainTimetable?'odpt:operator=odpt.Operator:TokyoMetro'&acl:consumerKey=' + _access_token,
	type: 'get',
	dataType: 'json',
	success: function( _json ){
		console.log( '東京メトロ 列車時刻表', _json );

	}
})
*/




$.ajax({
	url:
		[
			_api + 'odpt:TrainTimetable?',
			'odpt:operator=odpt.Operator:TokyoMetro',
			'&odpt:railway=odpt.Railway:TokyoMetro.Ginza',
			'&odpt:calendar=odpt.Calendar:Weekday',
			'&acl:consumerKey=' + _access_token
		].join('\n'),
	type: 'get',
	dataType: 'json',
	success: function( _json ){
		console.log( '東京メトロ 列車時刻表', _json );

		//	parse
		var _t = _textarea.text();

		for( var i = 0; i < _json.length; i++ )
		{
			var _tx = _json[i]['odpt:railway'].replace('odpt.Railway:TokyoMetro.','') + '\t' + _json[i]['odpt:calendar'].replace('odpt.Calendar:','') + '\t' + _json[i]['odpt:trainType'].replace('odpt.TrainType:TokyoMetro.','') + '\t' + _json[i]['odpt:trainNumber'];
			_t += _tx + "\n";

			var _t0 = '\t';
			var _t1 = '\t';
			var _t2 = '\t';

			var _timetable = _json[i]['odpt:trainTimetableObject'];
			var len = _timetable.length;
			for( var j = 0; j < len; j++ )
			{
				if( _timetable[j]['odpt:departureTime'] )
				{
					_t0 += _timetable[j]['odpt:departureStation'].replace('odpt.Station:TokyoMetro.Ginza.','') + '\t ';
					_t1 += _timetable[j]['odpt:departureTime'] + '\t ';

					var _time = _timetable[j]['odpt:departureTime'].split(':');
					_t2 += _time[0] * 60 * 60 + _time[1] * 60 + '\t';
				} else {
					_t0 += _timetable[j]['odpt:arrivalStation'].replace('odpt.Station:TokyoMetro.Ginza.','');
					_t1 += _timetable[j]['odpt:arrivalTime'];
					var _time = _timetable[j]['odpt:arrivalTime'].split(':');
					_t2 += _time[0] * 60 * 60 + _time[1] * 60 + '\t';
				}
				
			}
			_t += _t0 + '\n';
			_t += _t1 + '\n';
			_t += _t2 + '\n';
			_t += '\n';
		}

		_textarea.text( _t );

	}
})

/*
$.ajax({
	url:
		[
			_api + 'odpt:TrainTimetable?',
			'odpt:operator=odpt.Operator:TokyoMetro',
			//'&odpt:railway=odpt.Railway:TokyoMetro.Ginza',
			'&odpt:calendar=odpt.Calendar:Weekday',
			'&acl:consumerKey=' + _access_token
		].join('\n'),
	type: 'get',
	dataType: 'json',
	success: function( _json ){
		console.log( '実験線', _json );

		//	parse
		var _t = '';

		for( var i = 0; i < _json.length; i++ )
		{
			//	odpt:train: "odpt.Train:TokyoMetro.Ginza.A2201S"	
			var _tx = _json[i]['odpt:railway'] + '\t' + _json[i]['odpt:trainType'] + '\t' + _json[i]['odpt:trainNumber'];
			_t += _tx + "\n";
		}

		_textarea.text( _t );

	}
})
*/




setTimeout( function(){
	console.clear()

	var _railWay, _stations;

	$.ajax({
		url: _api + 'odpt:Railway?odpt:operator=odpt.Operator:JR-East&acl:consumerKey=' + _access_token,
		type: 'get',
		dataType: 'json',
		success: function( _json ){
			console.log( 'Railway', _json );
			_railWay = _json;

			var _t = '';

			$.ajax({
				url: _api + 'odpt:Station?odpt:operator=odpt.Operator:JR-East&acl:consumerKey=' + _access_token,
				type: 'get',
				dataType: 'json',
				success: function( _json ){
					console.log( 'Station', _json );
					_stations = _json;

					var _t = '';
					_t += '[';

					//	valueからkeyを抽出
					var _matchData = _railWay.filter(function(item, index){
						if (item['odpt:stationOrder'].length > 1 ) return true;
					});

					var len = _matchData.length;
					for( var i = 0; i < len; i++ )
					{
						//	console.log( '■', _matchData[i]['odpt:operator'], _matchData[i]['odpt:railwayTitle']['en'], _matchData[i]['odpt:railwayTitle']['ja']);


						_t += '[';

						var len2 = _matchData[i]['odpt:stationOrder'].length;
						for( var j = 0; j < len2; j++ )
						{
							var _name = _matchData[i]['odpt:stationOrder'][j]['odpt:station'];
							var _matchStationData = _stations.filter(function(item, index){
								if (item['owl:sameAs'] == _name ) return true;
							});

							//	console.log( _matchStationData.length, _matchStationData[0]['odpt:stationTitle']['en'], _matchStationData[0]['odpt:stationTitle']['ja'], _matchStationData[0]['geo:lat'], _matchStationData[0]['geo:long'] )

							_t += "{ 'en': " + _matchStationData[0]['odpt:stationTitle']['en'] + ", 'ja': " + _matchStationData[0]['odpt:stationTitle']['ja'] + ", 'lat': " + _matchStationData[0]['geo:lat'] + ", 'lng': " + _matchStationData[0]['geo:long'] + "},";
							
						}
						//	console.log(' ')


						_t += '],';
					}

					_t += ']';

					_textarea.text( _t );

					//	console.log( "マッチデータ", _matchData );




				}
			});
		}
	})
}, 2000 )

</script>
</body>
</html>
