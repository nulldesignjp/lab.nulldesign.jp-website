<!doctype html>
<html>
<head>
<meta charset="UTF-8">
<meta http-equiv="Content-Language" content="ja">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Script-Type" content="text/javascript">
<meta http-equiv="imagetoolbar" content="no">
<meta http-equiv="cleartype" content="on">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=yes, viewport-fit=cover">
<link href="../../main/shared/css/reset.css" rel="stylesheet" type="text/css" media="all">
<link href="../../main/shared/css/style.css" rel="stylesheet" type="text/css" media="all">
<meta name="keywords" content="">
<meta name="description" content="">
<title>SkyNet</title>

</head>
<body>
<div id="container">
<!--/ container --></div>



<!--
<script type="text/javascript" src="../../main/shared/js/stats.min.js"></script>
<script type="text/javascript" src="../../main/shared/js/jquery-3.3.1.min.js"></script>
<script type="text/javascript" src="../../main/shared/js/three.min.js"></script>
<script type="text/javascript" src="../../main/shared/js/OrbitControls.js"></script>
<script type="text/javascript" src="../../main/shared/js/SVGLoader.js"></script>
<script type="text/javascript" src="../../main/shared/js/SVGRenderer.js"></script>
<script type="text/javascript" src="world.js"></script>
-->
<!-- <script type="text/javascript" src="../../main/shared/js/world.js"></script> -->


<script type="text/javascript" src="../../main/shared/js/stats.min.js"></script>
<script type="text/javascript" src="../../main/shared/js/jquery-3.3.1.min.js"></script>
<script type="text/javascript" src="../../main/shared/js/three.min.js"></script>
<script type="text/javascript" src="../../main/shared/js/SVGLoader.js"></script>
<script type="text/javascript" src="../../main/shared/js/SVGRenderer.js"></script>
<script type="text/javascript" src="../../main/shared/js/OrbitControls.js"></script>
<script type="text/javascript" src="../../main/shared/js/SplineCurve.js"></script>
<script type="text/javascript" src="../../main/shared/js/shaderLib/CopyShader.js"></script>
<script type="text/javascript" src="../../main/shared/js/shaderLib/EffectComposer.js"></script>
<script type="text/javascript" src="../../main/shared/js/shaderLib/MaskPass.js"></script>
<script type="text/javascript" src="../../main/shared/js/shaderLib/RenderPass.js"></script>
<script type="text/javascript" src="../../main/shared/js/shaderLib/ShaderPass.js"></script>
<script type="text/javascript" src="../../main/shared/js/shader/FilmShader.js"></script>
<script type="text/javascript" src="../../main/shared/js/shader/HorizontalTiltShiftShader.js"></script>
<script type="text/javascript" src="../../main/shared/js/shader/VerticalTiltShiftShader.js"></script>
<script type="text/javascript" src="../../main/shared/js/shader/VignetteShader.js"></script>
<script type="text/javascript" src="../../main/shared/js/shader/RGBShiftShader.js"></script>
<script type="text/javascript" src="../../main/shared/js/shader/HueSaturationShader.js"></script>
<script type="text/javascript" src="../../main/shared/js/shader/BloomShader.js"></script>
<script type="text/javascript" src="../../main/shared/js/shader/InvertShader.js"></script>
<script type="text/javascript" src="../../main/shared/js/shader/MonoShader.js"></script>
<script type="text/javascript" src="../../main/shared/js/world.js"></script>


<script type="text/javascript" src="world.js"></script>




<script type="text/javascript">
window.onload = function()
{
  var style="color:white;background-color:#484848;padding: 3px 6px;";
  window.console.log("%cSkyNet - v1.0.0" , style);

  var _world = new world('container');
  _world.camera.position.set( 0, 300, 1000 );
  var _svg;


  //  stats
  var _stats = new Stats();
  $('#container').append( _stats.dom );
  // $( _stats.dom ).css({
  //   'left':'inherit',
  //   'right':'0px'
  // })
  
  _loop(0);
  function _loop( _time ){

    _time /= 1000;

    _stats.update();
    window.requestAnimationFrame( _loop );
  };


  // var _grid = new THREE.GridHelper( 1000, 10 )
  // _world.add( _grid )



    //  Load Map
    var guiData = {
      currentURL: 'sign.svg',
      drawFillShapes: true,
      drawStrokes: true,
      fillShapesWireframe: false,
      strokesWireframe: false
    }

    loadSVG( guiData, function( _mesh ){
      _world.add( _mesh );

      _svg = _mesh;

      _svg.rotation.x = Math.PI;

      //_svg.position.x = - 1920 * 0.5;
      //_svg.position.y = 1080 * 0.5;

      _svg.position.x *= 0.5;
      _svg.position.y *= 0.5;






      for( var i = 0; i < 32; i++ ){
        var __svg = _svg.clone();
        __svg.position.z = - ( i - 16 ) * 160.0;
        _world.add( __svg );

        __svg.rotation.z = Math.floor( Math.random() * 4.0 ) / 4.0 * Math.PI * 2.0;

        var _children = __svg.children;
        //console.log( _children)
        var len = _children.length;
        for( var j = 0; j < len; j++ )
        {
          _children[j].material.transparent = true;
          _children[j].material.opacity = 1.0 - i * 0.025;
        }

      }
    });


/*
*/

    function loadSVG( guiData, _callback ) {

      var url = guiData.currentURL;
      _callback = _callback==undefined?function(w){}:_callback;

      var loader = new THREE.SVGLoader();
      loader.load( url, function ( data ) {

        var paths = data.paths;

        var group = new THREE.Group();

        var _scale = 1.0;

            var _geometry = new THREE.Geometry();
            //  var material = new THREE.MeshBasicMaterial( {
            var _material = new THREE.MeshStandardMaterial( {
              //color: new THREE.Color().setStyle( fillColor ),
              color: 0xFFFFFF,
              // opacity: path.userData.style.fillOpacity,
              // transparent: path.userData.style.fillOpacity < 1,
              side: THREE.DoubleSide,
              //depthWrite: false,
              //wireframe: guiData.fillShapesWireframe
              roughness: 0.4,
              metalness: 0.6,
              emissive: 0x000000
            } );



        for ( var i = 0; i < paths.length; i ++ ) {

          var path = paths[ i ];

          var fillColor = path.userData.style.fill;
          if ( guiData.drawFillShapes && fillColor !== undefined && fillColor !== 'none') {

            var shapes = path.toShapes( true );

            for ( var j = 0; j < shapes.length; j ++ ) {

              var shape = shapes[ j ];

              var geometry = new THREE.ShapeBufferGeometry( shape );
              geometry.scale( _scale, _scale, _scale )

              var mesh = new THREE.Mesh( geometry );



              geometry = new THREE.Geometry().fromBufferGeometry( geometry );

              var _matrix = new THREE.Matrix4();

              //_matrix.makeRotationAxis ( new THREE.Vector3(0,0,1), Math.random() * Math.PI * 2.0 );
              // _matrix.makeTranslation(
              //   mesh.position.x,
              //   mesh.position.y,
              //   mesh.position.z
              // );

              _geometry.merge( geometry, _matrix );
 

            }

          }

          // var strokeColor = path.userData.style.stroke;

          // if ( guiData.drawStrokes && strokeColor !== undefined && strokeColor !== 'none' ) {

          //   var material = new THREE.MeshBasicMaterial( {
          //     color: new THREE.Color().setStyle( strokeColor ),
          //     opacity: path.userData.style.strokeOpacity,
          //     transparent: path.userData.style.strokeOpacity < 1,
          //     side: THREE.DoubleSide,
          //     //depthWrite: false,
          //     depthTest: false,
          //     wireframe: guiData.strokesWireframe
          //   } );

          //   for ( var j = 0, jl = path.subPaths.length; j < jl; j ++ ) {

          //     subPath = path.subPaths[ j ];

          //     var geometry = THREE.SVGLoader.pointsToStroke( subPath.getPoints(), path.userData.style );

          //     if ( geometry ) {

          //       var mesh = new THREE.Mesh( geometry, material );

          //       group.add( mesh );

          //     }

          //   }

          // }

        }

        var mesh = new THREE.Mesh( _geometry, _material );
        _callback( mesh );

      } );

    }



}

</script>
</body>
</html>
