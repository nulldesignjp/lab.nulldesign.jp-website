<!doctype html>
<html lang="ja-JP">
<head>
<title>re:creation</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
<meta name="keywords" content="">
<meta name="description" content="">
<link rel="stylesheet" type="text/css" href="assets/css/style.css" media="all">
</head>
<body>
    <!--
<h1>re:creation</h1>
<h2>Book</h2>
-->
<div id="webglView"></div>
<script type="x-shader/x-vertex" id="vertexshader">
uniform float time;
uniform vec3 gPosition;

uniform vec3 ppos[ num ];

varying vec3 vViewPosition;
#ifndef FLAT_SHADED
    varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
//const float PI = 3.141592;

//  https://qiita.com/7CIT/items/ad76cfa6771641951d31
float atan2(in float y, in float x){
    return x == 0.0 ? sign(y)*PI/2.0 : atan(y, x);
}

float random(vec2 co){
    return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

void main()
{
    #include <uv_vertex>
    #include <uv2_vertex>
    #include <color_vertex>
    #include <beginnormal_vertex>
    #include <morphnormal_vertex>
    #include <skinbase_vertex>
    #include <skinnormal_vertex>
    #include <defaultnormal_vertex>

#ifndef FLAT_SHADED
    vNormal = normalize( transformedNormal );
#endif
    #include <begin_vertex>
    #include <morphtarget_vertex>
    #include <skinning_vertex>
    #include <displacementmap_vertex>
    #include <project_vertex>
    #include <logdepthbuf_vertex>
    #include <clipping_planes_vertex>
    vViewPosition = - mvPosition.xyz;
    #include <worldpos_vertex>
    #include <envmap_vertex>
    #include <shadowmap_vertex>
    #include <fog_vertex>

    //  custom 
    vec3 _pos = position;

    //  base
    //  gl_Position = projectionMatrix * modelViewMatrix * vec4( _pos, 1.0 );

    vec4 modelPosition = modelMatrix * vec4( _pos, 1.0 );

    float _x = modelPosition.x;
    float _y = modelPosition.y;
    float _z = modelPosition.z;

    float _sin = sin( time );
    float _cos = cos( time );

    modelPosition.x = _x * _cos - _z * _sin;
    modelPosition.z = _x * _sin + _z * _cos;

    float rv = random( modelPosition.xz + vec2( time, 10.0 ) );
    int _r = int(floor( rv * float(num)));
    modelPosition.xyz = ppos[ _r ];

    //  custom
    gl_Position = projectionMatrix * viewMatrix * modelPosition;
}
</script>


<script type="x-shader/x-vertex" id="vertexshader2">
uniform float time;

uniform sampler2D map;

varying vec3 vViewPosition;
#ifndef FLAT_SHADED
    varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
//const float PI = 3.141592;

//  https://qiita.com/7CIT/items/ad76cfa6771641951d31
float atan2(in float y, in float x){
    return x == 0.0 ? sign(y)*PI/2.0 : atan(y, x);
}

float random(vec2 co){
    return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

void main()
{
    #include <uv_vertex>
    #include <uv2_vertex>
    #include <color_vertex>
    #include <beginnormal_vertex>
    #include <morphnormal_vertex>
    #include <skinbase_vertex>
    #include <skinnormal_vertex>
    #include <defaultnormal_vertex>

#ifndef FLAT_SHADED
    vNormal = normalize( transformedNormal );
#endif
    #include <begin_vertex>
    #include <morphtarget_vertex>
    #include <skinning_vertex>
    #include <displacementmap_vertex>
    #include <project_vertex>
    #include <logdepthbuf_vertex>
    #include <clipping_planes_vertex>
    vViewPosition = - mvPosition.xyz;
    #include <worldpos_vertex>
    #include <envmap_vertex>
    #include <shadowmap_vertex>
    #include <fog_vertex>

    //  custom 
    vec4 col = texture2D( map, uv );
    //  vec3 _pos = ( col.rgb - 0.5 ) * 500.0;

    vec3 _pos = vec3(0.0);
    //_pos.x = ( col.r - 0.5 ) * 1000.0;
    //_pos.z = ( col.b - 0.5 ) * 1000.0;
    _pos.y = ( ( col.r / col.g * col.b ) - 0.5 ) * 500.0;

    _pos.x = uv.x * 1000.0;
    _pos.z = uv.y * 1000.0;

    _pos.xz -= 500.0;

    vec4 modelPosition = modelMatrix * vec4( _pos, 1.0 );

    //  custom
    gl_Position = projectionMatrix * viewMatrix * modelPosition;
}
</script>
<script type="text/javascript" src="assets/js/dat.gui.min.js"></script>
<script type="text/javascript" src="assets/js/jquery-2.1.4.min.js"></script>
<script type="text/javascript" src="assets/js/three.min.js"></script>
<script type="text/javascript" src="assets/js/OrbitControls.js"></script>
<script type="text/javascript" src="assets/js/perlin-noise-simplex.js"></script>
<script type="text/javascript" src="assets/js/libs.js"></script>
<script type="text/javascript" src="assets/js/SplineCurve.js"></script>
<script type="text/javascript" src="assets/js/inflate.min.js"></script>
<script type="text/javascript" src="assets/js/FBXLoader.js"></script>
<script type="text/javascript" src="assets/js/OBJLoader.js"></script>
<script type="text/javascript" src="assets/js/world.js"></script>
<script type="text/javascript" src="assets/js/Tween.js"></script>
<script type="text/javascript" src="assets/js/engine.js"></script>
</body>
</html>