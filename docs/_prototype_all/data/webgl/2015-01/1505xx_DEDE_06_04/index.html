<!doctype>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=yes">
<meta name="keywords" content="">
<meta name="description" content="CLASS">
<title>DE DE MOUSE + HACKist</title>
<style>
html,body{height:100%;overflow:hidden;}
body{
	margin: 0;
	padding: 0;
	background: #000;
	color: #FFF;
	font-size: 12px;
	font-family: Arial;
}
#container{
	width: 100%;
	height: 100%;
}

h1,p{
	margin: 0;
	padding: 0;
	line-height: 1;
	position: fixed;
	z-index: 100;
	font-size: 1em;
}
h1{
	left: 32px;
	top: 32px;
}
p{
	left: 32px;
	bottom: 32px;
}
</style>
</head>
<body>
<h1>LightWave</h1>
<div id="container"></div>
<script src="../js/jquery-2.1.3.min.js"></script>
<script src="../js/Detector.js"></script>
<script src="../js/perlin-noise-simplex.js"></script>
<script src="../js/r71/three.min.js"></script>
<script src="../js/stats.min.js"></script>
<script src="../js/THREE.ConvexGeometry.js"></script>
<script src="world3d.js"></script>

<script type="x-shader/x-vertex" id="vertexshader">
void main()
{
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}
</script>
<script type="x-shader/x-fragment" id="fragmentshader">
#ifdef GL_ES
precision mediump float;
#endif

uniform float time;
uniform vec2 resolution;
uniform sampler2D px;
#define PI 3.14159265358979
#define N 15
void main( void ) {
    float size = 0.04;
    float dist = 0.0;
    float ang = 0.0;

    vec2 surfacePosition = gl_FragCoord.xy / resolution.xy - vec2( 0.5, 0.0 );

    vec2 pos = vec2(0.0,0.0);
    vec3 color = vec3(0.012, 0.012, 0.025);
    float time = time/4. - 4.*length(surfacePosition);
    for(int h=0; h<N; h++){
        for(int i=0; i<N; i++){
            float r = .2;
            ang += PI / (float(N+i+h)*.125);
            pos = vec2(cos(ang),sin(ang))*r*cos(time+ang/(float(h) + float(N)))*3.;
            pos *= sin(vec2(sin(ang),cos(ang))*r*cos(time+ang/(float(h) + float(N)))*5.);
            pos -= sin(vec2(sin(ang),cos(ang))*r*cos(time+ang/(float(h) + float(N)))*7.);
            dist += size / distance(pos,surfacePosition);
        }
    }
    gl_FragColor = vec4(color * dist, 1.0);
    
    //gl_FragColor += 0.975*pow(abs(texture2D(px, gl_FragCoord.xy/resolution) - gl_FragColor), vec4(1,1.006,1.008,0));
}
//+pk, winfix
</script>

<script type="text/javascript">

// var _scale = screen.width / ( 1280 * 3 );
// var _top = Math.floor( ( screen.height - 1024 * _scale ) * 0.5 );
// window.moveTo( 0, _top );
// window.resizeTo( 1280 * 3  * _scale, 1024 * _scale );

(function(){

    var uniforms = {
        volume: { type: "f", value: 0.0 },
        time: { type: "f", value: 1.0 },
        resolution: { type: "v2", value: new THREE.Vector2() },
        mouse: { type: "v2", value: new THREE.Vector2() }
    };
    uniforms.time.value = 0.0;
    uniforms.resolution.value.x = window.innerWidth;
    uniforms.resolution.value.y = window.innerHeight;
    uniforms.mouse.value.x = 0;
    uniforms.mouse.value.y = 0;
    uniforms.volume.value = 0.0;

    var _vertexShader = document.getElementById('vertexshader').textContent;
    var _fragmentShader = document.getElementById('fragmentshader').textContent;

    var _width = window.innerWidth;
    var _height = window.innerHeight;
    var _dom = document.getElementById('container');

    var camera = new THREE.OrthographicCamera(-_width * 0.5, _width * 0.5, _height * 0.5, -_height * 0.5, 0.1, 2000);
    //camera = new THREE.PerspectiveCamera( 35, _width / _height, 0.1, 2000 );
    camera.position.z = 1000;
    var focus = new THREE.Vector3();
    focus.set(0, 0, 0);
    camera.lookAt(focus);

    var scene = new THREE.Scene();
    scene.fog = new THREE.Fog(0x000000, 1200, 1500);
	//	renderer
	renderer = new THREE.WebGLRenderer({ antialias: false });
	renderer.setClearColor(scene.fog.color, 1);
	renderer.setSize(_width,_height);
	_dom.appendChild(renderer.domElement);

    var geometry = new THREE.PlaneGeometry(_width, _height, 1, 1 );
    var material = new THREE.ShaderMaterial({
        uniforms: uniforms,
        vertexShader: _vertexShader,
        fragmentShader: _fragmentShader
    });
    var mesh = new THREE.Mesh(geometry, material);
    scene.add(mesh);

    setInterval(function(){
    	uniforms.time.value += 0.05;
        camera.lookAt(focus);
        renderer.render(scene,camera);
    },1000/60);

})();
</script>
</body>
</html>