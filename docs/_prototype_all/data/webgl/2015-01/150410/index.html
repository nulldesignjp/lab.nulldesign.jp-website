<!doctype>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=yes">
<meta name="keywords" content="template,class check">
<meta name="description" content="">
<title>webgl sample</title>
<style>
html,body{height:100%;overflow:hidden;}
body{margin:0;padding:0;background:#000;color:#FFF;font-size:12px;font-family:Georgia;}
#container{width:100%;height:100%;}
canvas{position:fixed;left:0;top:0;}
h1,p{margin:0;padding:0;line-height:1;position:fixed;z-index:100;font-size:1em;}
h1{left:32px;top:32px;font-weight:normal;}
p{left:32px;bottom:32px;}
</style>
</head>
<body>
<h1>150410</h1>
<div id="container"></div>
<script src="../js/jquery-2.1.3.min.js"></script>
<script src="../js/Detector.js"></script>
<script src="../js/perlin-noise-simplex.js"></script>
<script src="../js/r71/three.min.js"></script>
<script src="../js/world3d.js"></script>
<script type="x-shader/x-vertex" id="vertexshader">
void main()
{
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}
</script>
<script type="x-shader/x-fragment" id="fragmentshader">
uniform float time;
uniform vec2 mouse;
uniform vec2 resolution;
const float PI = 3.141592;
void main()
{
	float size = 30.0;
	float color = 0.0;

	//	color
	//	vec3 mColor = vec3( 1.0, ( gl_FragCoord.xy / resolution.xy ) );
	vec3 mColor = vec3( (sin(time * 0.1)+1.0)*0.5, ( gl_FragCoord.xy / resolution.xy ) );

	float r = 100.0;
	float speed = 2.0;
	color += size / distance( gl_FragCoord.xy, mouse.xy*resolution.xy + vec2( cos((0.0*120.0)/180.0*PI-time*speed) * r, sin((0.0*120.0)/180.0*PI-time*speed) * r ) );
	color += size / distance( gl_FragCoord.xy, mouse.xy*resolution.xy + vec2( cos((1.0*120.0)/180.0*PI-time*speed) * r, sin((1.0*120.0)/180.0*PI-time*speed) * r ) );
	color += size / distance( gl_FragCoord.xy, mouse.xy*resolution.xy + vec2( cos((2.0*120.0)/180.0*PI-time*speed) * r, sin((2.0*120.0)/180.0*PI-time*speed) * r ) );

	color += size * 0.2 / distance( gl_FragCoord.xy, mouse.xy*resolution.xy + vec2( cos((0.5*120.0)/180.0*PI+time*speed) * r * 0.5, sin((0.5*120.0)/180.0*PI+time*speed) * r * 0.5 ) );
	color += size * 0.2 / distance( gl_FragCoord.xy, mouse.xy*resolution.xy + vec2( cos((1.5*120.0)/180.0*PI+time*speed) * r * 0.5, sin((1.5*120.0)/180.0*PI+time*speed) * r * 0.5 ) );
	color += size * 0.2 / distance( gl_FragCoord.xy, mouse.xy*resolution.xy + vec2( cos((2.5*120.0)/180.0*PI+time*speed) * r * 0.5, sin((2.5*120.0)/180.0*PI+time*speed) * r * 0.5 ) );

	color += size * 0.05 / distance( gl_FragCoord.xy, mouse.xy*resolution.xy + vec2( cos((0.0*120.0)/180.0*PI-time*speed) * r * 0.2, sin((0.0*120.0)/180.0*PI-time*speed) * r * 0.2 ) );
	color += size * 0.05 / distance( gl_FragCoord.xy, mouse.xy*resolution.xy + vec2( cos((1.0*120.0)/180.0*PI-time*speed) * r * 0.2, sin((1.0*120.0)/180.0*PI-time*speed) * r * 0.2 ) );
	color += size * 0.05 / distance( gl_FragCoord.xy, mouse.xy*resolution.xy + vec2( cos((2.0*120.0)/180.0*PI-time*speed) * r * 0.2, sin((2.0*120.0)/180.0*PI-time*speed) * r * 0.2 ) );

	gl_FragColor = vec4( vec3( color ) * mColor, 1.0 );
}
</script>

<script type="text/javascript">
(function(){
	var _perlinNoise = new SimplexNoise();
	var _value = _perlinNoise.noise( 0, 0 );
	var _world = new world3d.three( document.getElementById('container') );

	var geometry = new THREE.BoxGeometry( 100,100,100,3,3,3);
	var material = new THREE.MeshNormalMaterial();
	var mesh = new THREE.Mesh( geometry, material );
	_world.scene.add( mesh )

	_world.engine = function(){
		mesh.rotation.x += 0.01;
		mesh.rotation.y += 0.01;
		mesh.rotation.z += 0.01;
	}

	//	uniforms
	var uniforms = {
		time: { type: "f", value: 1.0 },
		resolution: { type: "v2", value: new THREE.Vector2() },
		mouse: { type: "v2", value: new THREE.Vector2() }
	};
	uniforms.time.value = 0.0;
	uniforms.resolution.value.x = window.innerWidth;
	uniforms.resolution.value.y = window.innerHeight;
	uniforms.mouse.value.x = 0;
	uniforms.mouse.value.y = 0;

	//	world
	var _dom = document.getElementById('container');
	var _vertexShader = document.getElementById('vertexshader').textContent;
	var _fragmentShader = document.getElementById('fragmentshader').textContent;
	var _world = new world3d.shader( _dom, _vertexShader, _fragmentShader, uniforms );
})();
</script>
</body>
</html>