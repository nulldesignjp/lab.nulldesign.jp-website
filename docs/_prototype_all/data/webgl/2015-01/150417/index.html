<!doctype>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=yes">
<meta name="keywords" content="blender, practice">
<meta name="description" content="">
<title>webgl sample</title>
<style>
html,body{height:100%;overflow:hidden;}
body{margin:0;padding:0;background:#000;color:#FFF;font-size:12px;font-family:Georgia;}
#container{width:100%;height:100%;}
canvas{position:fixed;left:0;top:0;}
h1,p{margin:0;padding:0;line-height:1;position:fixed;z-index:100;font-size:1em;}
h1{left:16px;top:64px;font-weight:normal;}
p{left:16px;bottom:32px;}
</style>
</head>
<body>
<h1>150417</h1>
<div id="container"></div>
<script src="../js/jquery-2.1.3.min.js"></script>
<script src="../js/Detector.js"></script>
<script src="../js/perlin-noise-simplex.js"></script>
<script src="../js/r71/three.min.js"></script>
<script src="../js/stats.min.js"></script>
<script src="../js/THREE.ConvexGeometry.js"></script>
<script src="world3d.js"></script>

<script type="text/javascript">
(function(){

	//	stats
	var stats;
	createStats();

	//	perlinNoise
	var _perlinNoise = new SimplexNoise();
	var _value = _perlinNoise.noise( 0, 0 );

	var _world = new world3d.three( document.getElementById('container') );
	var _group = new THREE.Group();
	_world.scene.add( _group );

	var _l0 = new THREE.AmbientLight( 0x181818 );
	_world.scene.add( _l0 );

	var _l1 = new THREE.DirectionalLight( 0xCCCCCC, 1.0 );
	_l1.position.set( 1, 1, 1 );
	_world.scene.add( _l1 );

	var _l2 = new THREE.SpotLight( 0xCCCCCC );
	_l2.position.set( 100, 1000, 100 );
	// spotLight.castShadow = true;

	// spotLight.shadowMapWidth = 1024;
	// spotLight.shadowMapHeight = 1024;

	// spotLight.shadowCameraNear = 500;
	// spotLight.shadowCameraFar = 4000;
	// spotLight.shadowCameraFov = 30;
	_world.scene.add( _l2 );

	var geometry = new THREE.SphereGeometry( 50,8,6 );
	var material = new THREE.MeshLambertMaterial({shading: THREE.FlatShading});
    var _mesh = new THREE.Mesh( geometry, material );
    _mesh.position.x = 200;
    _group.add( _mesh );

	var geometry = new THREE.IcosahedronGeometry( 50,1 );
	var material = new THREE.MeshLambertMaterial({shading: THREE.FlatShading});
    var _mesh = new THREE.Mesh( geometry, material );
    _mesh.position.x = -200;
    _group.add( _mesh );

    //	http://www.atmarkit.co.jp/ait/articles/1210/04/news142_2.html
	var mesh   = new THREE.Object3D(); // 読み込みが完了するまでのダミー
	var loader = new THREE.JSONLoader();
	loader.load( 'untitled.json', function ( geometry, materials ) {
		var material = new THREE.MeshFaceMaterial( materials );
		console.log( geometry, materials, material );
		mesh = new THREE.Mesh( geometry, material );
		mesh.scale.x = mesh.scale.y = mesh.scale.z = 100;

		materials[0].shading = THREE.FlatShading;
		//materials[0].wireframe = true;
		_group.add( mesh );
	} );

	_world.engine = function(){
		stats.update();

		mesh.rotation.x += 0.01;
		mesh.rotation.y += 0.01;
		mesh.rotation.z += 0.01;

		//
		_world.camera.position.x = Math.sin( Date.now() * 0.001 ) * 600;
		_world.camera.position.y = Math.cos( Date.now() * 0.001 ) * 300;
	}

	function createStats()
	{
		stats = new Stats();
		stats.domElement.style.position = 'fixed';
		stats.domElement.style.left = "3px";
		stats.domElement.style.top = '3px';
		stats.domElement.style.zIndex = '100';
		document.getElementById('container').appendChild( stats.domElement );
	}
})();
</script>
</body>
</html>