<!DOCTYPE HTML>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=yes">
<meta name="keywords" content="">
<meta name="description" content="">
<title>TypeScript</title>
<style>
html,body{	height: 100%;	overflow: hidden;	}
body{	margin: 0; padding: 0;}
h1{
	font-size: 16px;
	font-family: Arial;
	position: fixed;
	left: 16px;
	top: 16px;
	margin: 0;
	padding: 0;
	line-height: 1.0;
}
#resultBlock{
	position: fixed;
	left: 16px;
	top: 48px;
}
</style>
</head>
<body>
<h1>ベクトルの内積/外積 衝突判定の学習</h1>
<canvas id="canvas"></canvas>
<div id="resultBlock"></div>
<script type="text/javascript" src="jquery-2.1.1.min.js"></script>
<script type="text/javascript" src="vector3.js"></script>
<script type="text/javascript">
(function(){

	var _blist = [];

	var _w = window.innerWidth;
	var _h = window.innerHeight;

	var _canvas = document.getElementById('canvas');
	var _ctx = _canvas.getContext('2d');
	var fps = 60;
	var pointer = {x:_w * 0.5,y:_h * 0.5};
	var mouse = {x:0,y:0};

	_canvas.width = _w;
	_canvas.height = _h;

	$( window ).on( 'mousemove', _onmousemove );
	$( window ).on( 'resize', _onresize );




	var len = 100;
	for( var i = 0; i < len; i++ )
	{
		var _obj = {
			'body': new vector3(Math.floor( Math.random() * _w ), Math.floor( Math.random() * _h ), 0 ),
			'vector': new vector3( 0, 0, 0 )
		}
		_blist.push( _obj );
	}

	setInterval( _loop, 1000/fps);

	function _loop( e )
	{
		var _w = window.innerWidth;
		var _h = window.innerHeight;

		_ctx.beginPath()
		_ctx.clearRect( 0, 0, _w, _h );

		_ctx.strokeStyle = '#000000';
		_ctx.moveTo( pointer.x, pointer.y );
		_ctx.lineTo( mouse.x, mouse.y );

		_ctx.stroke();

		var _dx = mouse.x - pointer.x;
		var _dy = mouse.y - pointer.y;
		var _pow = Math.sqrt( _dx * _dx + _dy * _dy );
		var _cos = _dx / _pow;
		var _sin = _dy / _pow;
		var _dot = _pow * _cos;
		var _cross = _pow * _sin;

		_ctx.moveTo( pointer.x, pointer.y );
		_ctx.lineTo( pointer.x + 100, pointer.y );
		_ctx.stroke();

		_ctx.beginPath()
		_ctx.strokeStyle = '#FF0000';
		_ctx.moveTo( mouse.x, mouse.y );
		_ctx.lineTo( mouse.x, pointer.y );
		_ctx.moveTo( mouse.x + 5, pointer.y );
		_ctx.arc( mouse.x, pointer.y, 5, 0, Math.PI * 2 );
		_ctx.stroke();

		var _result = '';
		_result += 'Vector: ' + _pow + '<br>';
		_result += 'Cos(θ): ' + _cos + '<br>';
		_result += 'Sin(θ): ' + _sin + '<br>';
		_result += 'Dot(内積): ' + _dot + '<br>';
		_result += 'Cross(外積): ' + _cross + '<br>';

		$('#resultBlock').html(_result);

		/*
		_ctx.beginPath()
		_ctx.fillStyle = '#FFF000';
		var len = _blist.length;
		while( len )
		{
			len--;
			var _b = _blist[len];

			if( len )
			{
				var len2 = len - 1;
				var _b0 = _blist[len2];

				var _d = vector3.distance( _b, _b0 );
				if( _d < 100 )
				{
					if( _d > 50 )
					{
						_b.vector.x += 0.1;
						_b0.vector.x -= 0.1;
					} else {

					}
				}
			}




			_b.body.x += _b.vector.x;
			_b.body.y += _b.vector.y;

			_ctx.moveTo( _b.body.x, _b.body.y );
			_ctx.arc( _b.body.x, _b.body.y, 5, 0, Math.PI * 2 );
		}
		_ctx.fill();

		*/

	}

	function _onmousemove(e)
	{
		mouse.x = e.originalEvent.pageX;
		mouse.y = e.originalEvent.pageY;
	}

	function _onouseclick(e)
	{
		pointer.x = e.originalEvent.pageX;
		pointer.y = e.originalEvent.pageY;
	}

	function _onresize(e)
	{
		var _w = window.innerWidth;
		var _h = window.innerHeight;
		_canvas.width = _w;
		_canvas.height = _h;

		pointer.x = _w * 0.5;
		pointer.y = _h * 0.5;
	}
})();
</script>
</body>
</html>

